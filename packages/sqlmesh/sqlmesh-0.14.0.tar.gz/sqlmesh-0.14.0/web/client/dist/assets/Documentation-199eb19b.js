import{r as c,R as C,j as r,i as G,g as I,aj as de,al as fe,U as xe,a5 as pe}from"./index-61767e52.js";import{u as me,M as be,C as L}from"./Graph-345ed406.js";import{a as he}from"./editor-a05a9ee2.js";import{g as le,i as ge,S as se,D as U,y as B,s as K,o as D,l as X,X as q,I as ae,u as _,f as k,N as W,j as ve,a as y,O as F,M as w,w as je}from"./transition-994df1e0.js";import{s as ye}from"./popover-f6509dad.js";import{v as J,M as we,P as Ne}from"./disclosure-97649b9e.js";function Te({onFocus:e}){let[t,n]=c.useState(!0);return t?C.createElement(le,{as:"button",type:"button",features:ge.Focusable,onFocus:s=>{s.preventDefault();let l,a=50;function i(){if(a--<=0){l&&cancelAnimationFrame(l);return}if(e()){n(!1),cancelAnimationFrame(l);return}l=requestAnimationFrame(i)}l=requestAnimationFrame(i)}}):null}const ie=c.createContext(null);function Ie(){return{groups:new Map,get(e,t){var n;let s=this.groups.get(e);s||(s=new Map,this.groups.set(e,s));let l=(n=s.get(t))!=null?n:0;s.set(t,l+1);let a=Array.from(s.keys()).indexOf(t);function i(){let p=s.get(t);p>1?s.set(t,p-1):s.delete(t)}return[a,i]}}}function Pe({children:e}){let t=c.useRef(Ie());return c.createElement(ie.Provider,{value:t},e)}function oe(e){let t=c.useContext(ie);if(!t)throw new Error("You must wrap your component in a <StableCollection>");let n=Ee(),[s,l]=t.current.get(e,n);return c.useEffect(()=>l,[]),s}function Ee(){var e,t,n;let s=(n=(t=(e=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)==null?void 0:e.ReactCurrentOwner)==null?void 0:t.current)!=null?n:null;if(!s)return Symbol();let l=[],a=s;for(;a;)l.push(a.index),a=a.return;return"$."+l.join(".")}var Se=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Se||{}),$e=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))($e||{}),De=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(De||{});let Fe={[0](e,t){var n;let s=k(e.tabs,o=>o.current),l=k(e.panels,o=>o.current),a=s.filter(o=>{var g;return!((g=o.current)!=null&&g.hasAttribute("disabled"))}),i={...e,tabs:s,panels:l};if(t.index<0||t.index>s.length-1){let o=_(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,[0]:()=>_(Math.sign(t.index),{[-1]:()=>0,[0]:()=>0,[1]:()=>1}),[1]:()=>0});return a.length===0?i:{...i,selectedIndex:_(o,{[0]:()=>s.indexOf(a[0]),[1]:()=>s.indexOf(a[a.length-1])})}}let p=s.slice(0,t.index),m=[...s.slice(t.index),...p].find(o=>a.includes(o));if(!m)return i;let d=(n=s.indexOf(m))!=null?n:e.selectedIndex;return d===-1&&(d=e.selectedIndex),{...i,selectedIndex:d}},[1](e,t){var n;if(e.tabs.includes(t.tab))return e;let s=e.tabs[e.selectedIndex],l=k([...e.tabs,t.tab],i=>i.current),a=(n=l.indexOf(s))!=null?n:e.selectedIndex;return a===-1&&(a=e.selectedIndex),{...e,tabs:l,selectedIndex:a}},[2](e,t){return{...e,tabs:e.tabs.filter(n=>n!==t.tab)}},[3](e,t){return e.panels.includes(t.panel)?e:{...e,panels:k([...e.panels,t.panel],n=>n.current)}},[4](e,t){return{...e,panels:e.panels.filter(n=>n!==t.panel)}}},V=c.createContext(null);V.displayName="TabsDataContext";function R(e){let t=c.useContext(V);if(t===null){let n=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,R),n}return t}let Z=c.createContext(null);Z.displayName="TabsActionsContext";function ee(e){let t=c.useContext(Z);if(t===null){let n=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,ee),n}return t}function Ce(e,t){return _(t.type,Fe,e,t)}let Re=c.Fragment;function Me(e,t){let{defaultIndex:n=0,vertical:s=!1,manual:l=!1,onChange:a,selectedIndex:i=null,...p}=e;const m=s?"vertical":"horizontal",d=l?"manual":"auto";let o=i!==null,g=B(t),[f,j]=c.useReducer(Ce,{selectedIndex:i??n,tabs:[],panels:[]}),b=c.useMemo(()=>({selectedIndex:f.selectedIndex}),[f.selectedIndex]),M=K(a||(()=>{})),A=K(f.tabs),h=c.useMemo(()=>({orientation:m,activation:d,...f}),[m,d,f]),v=D(x=>(j({type:1,tab:x}),()=>j({type:2,tab:x}))),P=D(x=>(j({type:3,panel:x}),()=>j({type:4,panel:x}))),E=D(x=>{S.current!==x&&M.current(x),o||j({type:0,index:x})}),S=K(o?e.selectedIndex:f.selectedIndex),Q=c.useMemo(()=>({registerTab:v,registerPanel:P,change:E}),[]);X(()=>{j({type:0,index:i??n})},[i]),X(()=>{if(S.current===void 0||f.tabs.length<=0)return;let x=k(f.tabs,T=>T.current);x.some((T,u)=>f.tabs[u]!==T)&&E(x.indexOf(f.tabs[S.current]))});let Y={ref:g};return C.createElement(Pe,null,C.createElement(Z.Provider,{value:Q},C.createElement(V.Provider,{value:h},h.tabs.length<=0&&C.createElement(Te,{onFocus:()=>{var x,T;for(let u of A.current)if(((x=u.current)==null?void 0:x.tabIndex)===0)return(T=u.current)==null||T.focus(),!0;return!1}}),q({ourProps:Y,theirProps:p,slot:b,defaultTag:Re,name:"Tabs"}))))}let Ae="div";function Le(e,t){let{orientation:n,selectedIndex:s}=R("Tab.List"),l=B(t);return q({ourProps:{ref:l,role:"tablist","aria-orientation":n},theirProps:e,slot:{selectedIndex:s},defaultTag:Ae,name:"Tabs.List"})}let Oe="button";function ke(e,t){var n,s;let l=ae(),{id:a=`headlessui-tabs-tab-${l}`,...i}=e,{orientation:p,activation:m,selectedIndex:d,tabs:o,panels:g}=R("Tab"),f=ee("Tab"),j=R("Tab"),b=c.useRef(null),M=B(b,t);X(()=>f.registerTab(b),[f,b]);let A=oe("tabs"),h=o.indexOf(b);h===-1&&(h=A);let v=h===d,P=D(u=>{var N;let z=u();if(z===W.Success&&m==="auto"){let ue=(N=ve(b))==null?void 0:N.activeElement,re=j.tabs.findIndex(ce=>ce.current===ue);re!==-1&&f.change(re)}return z}),E=D(u=>{let N=o.map(z=>z.current).filter(Boolean);if(u.key===y.Space||u.key===y.Enter){u.preventDefault(),u.stopPropagation(),f.change(h);return}switch(u.key){case y.Home:case y.PageUp:return u.preventDefault(),u.stopPropagation(),P(()=>F(N,w.First));case y.End:case y.PageDown:return u.preventDefault(),u.stopPropagation(),P(()=>F(N,w.Last))}if(P(()=>_(p,{vertical(){return u.key===y.ArrowUp?F(N,w.Previous|w.WrapAround):u.key===y.ArrowDown?F(N,w.Next|w.WrapAround):W.Error},horizontal(){return u.key===y.ArrowLeft?F(N,w.Previous|w.WrapAround):u.key===y.ArrowRight?F(N,w.Next|w.WrapAround):W.Error}}))===W.Success)return u.preventDefault()}),S=c.useRef(!1),Q=D(()=>{var u;S.current||(S.current=!0,(u=b.current)==null||u.focus(),f.change(h),je(()=>{S.current=!1}))}),Y=D(u=>{u.preventDefault()}),x=c.useMemo(()=>({selected:v}),[v]),T={ref:M,onKeyDown:E,onMouseDown:Y,onClick:Q,id:a,role:"tab",type:ye(e,b),"aria-controls":(s=(n=g[h])==null?void 0:n.current)==null?void 0:s.id,"aria-selected":v,tabIndex:v?0:-1};return q({ourProps:T,theirProps:i,slot:x,defaultTag:Oe,name:"Tabs.Tab"})}let _e="div";function Ue(e,t){let{selectedIndex:n}=R("Tab.Panels"),s=B(t),l=c.useMemo(()=>({selectedIndex:n}),[n]);return q({ourProps:{ref:s},theirProps:e,slot:l,defaultTag:_e,name:"Tabs.Panels"})}let Be="div",qe=se.RenderStrategy|se.Static;function ze(e,t){var n,s,l,a;let i=ae(),{id:p=`headlessui-tabs-panel-${i}`,tabIndex:m=0,...d}=e,{selectedIndex:o,tabs:g,panels:f}=R("Tab.Panel"),j=ee("Tab.Panel"),b=c.useRef(null),M=B(b,t);X(()=>j.registerPanel(b),[j,b]);let A=oe("panels"),h=f.indexOf(b);h===-1&&(h=A);let v=h===o,P=c.useMemo(()=>({selected:v}),[v]),E={ref:M,id:p,role:"tabpanel","aria-labelledby":(s=(n=g[h])==null?void 0:n.current)==null?void 0:s.id,tabIndex:v?m:-1};return!v&&((l=d.unmount)==null||l)&&!((a=d.static)!=null&&a)?C.createElement(le,{as:"span",...E}):q({ourProps:E,theirProps:d,slot:P,defaultTag:Be,features:qe,visible:v,name:"Tabs.Panel"})}let Ge=U(ke),We=U(Me),He=U(Le),Xe=U(Ue),Qe=U(ze),$=Object.assign(Ge,{Group:We,List:He,Panels:Xe,Panel:Qe});const te=function({model:t,withModel:n=!0,withDescription:s=!0,withColumns:l=!0,withCode:a=!0,withQuery:i=!0}){const{handleClickModel:p}=he(),m=me(t.path,d=>{p==null||p(d.name)});return r.jsxs(ne,{children:[n&&r.jsx(H,{headline:"Model",defaultOpen:!0,children:r.jsxs("ul",{className:"px-2 w-full",children:[r.jsx(O,{name:"Path",value:t.path.split("/").slice(0,-1).join("/")}),r.jsx(O,{name:"Name",value:t.name}),r.jsx(O,{name:"Dialect",value:t.dialect}),r.jsx(O,{name:"Type",value:t.type}),Object.entries(t.details??{}).map(([d,o])=>r.jsx(O,{name:d.replaceAll("_"," "),value:o,isCapitalize:!0},d))]})}),s&&r.jsx(H,{headline:"Description",defaultOpen:!0,children:t.description==null?"No description":t.description}),l&&r.jsx(H,{headline:"Columns",children:r.jsx(be,{className:"max-h-[15rem]",nodeId:t.name,columns:t.columns,disabled:(t==null?void 0:t.type)==="python",withHandles:!1,withSource:!1,limit:10})}),(a||i)&&r.jsx(H,{headline:"SQL",children:r.jsx(L.RemoteFile,{path:t.path,children:({file:d})=>r.jsx(r.Fragment,{children:r.jsxs($.Group,{defaultIndex:i?1:0,children:[r.jsxs($.List,{className:"w-full whitespace-nowrap px-2 pt-3 flex justify-center items-center",children:[r.jsx($,{disabled:G(a),className:({selected:o})=>I("inline-block font-medium px-3 py-1 mr-2 last-child:mr-0 rounded-md relative",o?"bg-secondary-500 text-secondary-100 cursor-default":"bg-secondary-10 ",G(a)?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:"Source Code"}),r.jsx($,{disabled:G(i),className:({selected:o})=>I("inline-block font-medium px-3 py-1 mr-2 last-child:mr-0 rounded-md relative",o?"bg-secondary-500 text-secondary-100 cursor-default":"bg-secondary-10 ",G(i)?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:"Compiled Query"})]}),r.jsxs($.Panels,{className:"h-full w-full overflow-hidden bg-neutral-10 mt-4 rounded-lg",children:[r.jsx($.Panel,{unmount:!1,className:I("flex flex-col w-full h-full relative px-2 overflow-hidden p-2","ring-white ring-opacity-60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2"),children:r.jsx(L.SQLMeshDialect,{content:d.content,type:d.extension,children:({extensions:o,content:g})=>r.jsx(L,{extensions:o.concat(m),content:g,className:"text-xs"})})}),r.jsx($.Panel,{unmount:!1,className:I("w-full h-full ring-white ring-opacity-60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2 p-2"),children:r.jsx(L.Default,{type:de.SQL,content:t.sql??"",children:({extensions:o,content:g})=>r.jsx(L,{extensions:o.concat(m),content:g,className:"text-xs"})})})]})]})})})})]})};function Ye({headline:e}){return r.jsx("div",{className:"text-lg font-bold whitespace-nowrap w-full",id:e,children:r.jsx("h3",{className:"py-2",children:e})})}function Ke(){return r.jsx(ne,{className:"font-bold whitespace-nowrap w-full h-full",children:r.jsx("div",{className:"flex items-center justify-center w-full h-full",children:"Documentation Not Found"})})}function ne({children:e,className:t}){return r.jsx("div",{className:I("w-full h-full rounded-xl",t),children:r.jsx("div",{className:"w-full h-full py-4 rounded-xl",children:r.jsx("div",{className:"w-full h-full overflow-auto scrollbar scrollbar--vertical scrollbar--horizontal",children:e})})})}function H({children:e,className:t,headline:n,defaultOpen:s=!1}){return r.jsx("div",{className:"px-4",children:r.jsx(J,{defaultOpen:s,children:({open:l})=>r.jsxs(r.Fragment,{children:[r.jsxs(J.Button,{className:I("flex items-center justify-between rounded-lg text-left w-full bg-neutral-10 px-3 mb-2",t),children:[r.jsx(Ye,{headline:n}),r.jsx("div",{children:l?r.jsx(we,{className:"h-6 w-6 text-neutral-50"}):r.jsx(Ne,{className:"h-6 w-6 text-neutral-50"})})]}),r.jsx(J.Panel,{className:"pb-2 overflow-hidden",children:r.jsx("div",{className:"px-2",children:e})})]})})})}function O({className:e,name:t,value:n,isHighlighted:s=!1,isCapitalize:l=!1,children:a}){const i=new Date(n),p=fe(n)&&!isNaN(i.getTime()),m=typeof n=="boolean";return r.jsxs("li",{className:I("w-full border-b border-primary-10 py-1 mb-1",e),children:[r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("strong",{className:I("mr-2",l&&"capitalize",s&&"text-brand-500"),children:t}),r.jsx("p",{className:"text-xs rounded text-neutral-500 dark:text-neutral-400",children:m?xe(n)?"True":"False":p?pe(i):n})]}),r.jsx("p",{className:"text-xs ",children:a})]})}te.NotFound=Ke;te.Container=ne;const rt=te;export{rt as D,$ as r};
