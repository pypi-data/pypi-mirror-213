import{n as j,u as v,p as r,j as t,g as P,r as b,I as i,x as n,B as A,b as C,A as k,z as p,J as E}from"./index-61767e52.js";import{T as l}from"./TasksOverview-41e76911.js";import{L as o}from"./popover-f6509dad.js";import{t as F}from"./transition-994df1e0.js";import"./pluralize-853350c8.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./context-e75003df.js";function L({plan:a}){const d=j(),x=v(e=>e.environment),s=r(e=>e.state),c=r(e=>e.setState),u=r(e=>e.setAction);function g(){c(n.Cancelling),u(p.Cancelling),E(d).catch(console.error).finally(()=>{u(p.None),c(n.Cancelled)})}return t.jsx(o,{className:"relative flex",children:()=>t.jsxs(t.Fragment,{children:[t.jsx(o.Button,{className:P("inline-block ml-1 px-2 py-[3px] rounded-[4px] text-xs font-bold",N(s)),children:a==null?0:1}),t.jsx(F,{as:b.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:t.jsx(o.Panel,{className:"absolute right-1 z-10 mt-8 transform",children:t.jsxs("div",{className:"overflow-hidden rounded-lg bg-theme shadow-lg ring-1 ring-black ring-opacity-5",children:[t.jsx(l,{tasks:a.tasks,children:({total:e,completed:h,models:m,completedBatches:y,totalBatches:f})=>t.jsxs(t.Fragment,{children:[t.jsx(l.Summary,{environment:x.name,planState:s,headline:"Most Recent Plan",completed:h,total:e,completedBatches:y,totalBatches:f,updateType:a.type===i.Virtual?"Virtual":"Backfill",updatedAt:a.updated_at}),m!=null&&t.jsx(l.Details,{models:m,showBatches:a.type!==i.Virtual,showVirtualUpdate:a.type===i.Virtual,showProgress:!0})]})}),t.jsx("div",{className:"my-4 px-4",children:s===n.Applying&&t.jsx(A,{size:C.sm,variant:k.Danger,className:"mx-0",onClick:e=>{e.stopPropagation(),g()},children:"Cancel"})})]})})})]})})}function N(a){return a===n.Finished?"bg-success-500 text-light":a===n.Failed?"bg-danger-500 text-light":a===n.Applying?"bg-secondary-500 text-light":"bg-neutral-100 text-neutral-500"}export{L as default};
