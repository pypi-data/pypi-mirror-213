import{r as u,R as C}from"./index-61767e52.js";import{l as Y,S as X,D as W,y as j,A as ve,n as ee,F as te,s as ue,o as y,E as fe,L as Pe,c as be,u as N,d as K,X as q,I as A,q as se,g as Z,i as _,C as ie,O as G,M as R,h as me,T as Se,a as L,r as ce,j as ye,v as D,N as z}from"./transition-994df1e0.js";function ae(e){var n;if(e.type)return e.type;let p=(n=e.as)!=null?n:"button";if(typeof p=="string"&&p.toLowerCase()==="button")return"button"}function Ee(e,n){let[p,m]=u.useState(()=>ae(e));return Y(()=>{m(ae(e))},[e.type,e.as]),Y(()=>{p||n.current&&n.current instanceof HTMLButtonElement&&!n.current.hasAttribute("type")&&m("button")},[p,n]),p}var ge=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ge||{}),Ie=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Ie||{});let $e={[0]:e=>({...e,popoverState:N(e.popoverState,{[0]:1,[1]:0})}),[1](e){return e.popoverState===1?e:{...e,popoverState:1}},[2](e,n){return e.button===n.button?e:{...e,button:n.button}},[3](e,n){return e.buttonId===n.buttonId?e:{...e,buttonId:n.buttonId}},[4](e,n){return e.panel===n.panel?e:{...e,panel:n.panel}},[5](e,n){return e.panelId===n.panelId?e:{...e,panelId:n.panelId}}},ne=u.createContext(null);ne.displayName="PopoverContext";function J(e){let n=u.useContext(ne);if(n===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,J),p}return n}let re=u.createContext(null);re.displayName="PopoverAPIContext";function oe(e){let n=u.useContext(re);if(n===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,oe),p}return n}let le=u.createContext(null);le.displayName="PopoverGroupContext";function pe(){return u.useContext(le)}let Q=u.createContext(null);Q.displayName="PopoverPanelContext";function he(){return u.useContext(Q)}function xe(e,n){return N(n.type,$e,e,n)}let Ce="div";function Te(e,n){var p;let m=u.useRef(null),$=j(n,ve(t=>{m.current=t})),l=u.useRef([]),r=u.useReducer(xe,{popoverState:1,buttons:l,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:u.createRef(),afterPanelSentinel:u.createRef()}),[{popoverState:f,button:s,buttonId:h,panel:b,panelId:E,beforePanelSentinel:i,afterPanelSentinel:k},v]=r,d=ee((p=m.current)!=null?p:s),S=u.useMemo(()=>{if(!s||!b)return!1;for(let V of document.querySelectorAll("body > *"))if(Number(V==null?void 0:V.contains(s))^Number(V==null?void 0:V.contains(b)))return!0;let t=te(),a=t.indexOf(s),x=(a+t.length-1)%t.length,M=(a+1)%t.length,U=t[x],de=t[M];return!b.contains(U)&&!b.contains(de)},[s,b]),g=ue(h),w=ue(E),T=u.useMemo(()=>({buttonId:g,panelId:w,close:()=>v({type:1})}),[g,w,v]),B=pe(),O=B==null?void 0:B.registerPopover,H=y(()=>{var t;return(t=B==null?void 0:B.isFocusWithinPopoverGroup())!=null?t:(d==null?void 0:d.activeElement)&&((s==null?void 0:s.contains(d.activeElement))||(b==null?void 0:b.contains(d.activeElement)))});u.useEffect(()=>O==null?void 0:O(T),[O,T]),fe(d==null?void 0:d.defaultView,"focus",t=>{var a,x,M,U;f===0&&(H()||s&&b&&t.target!==window&&((x=(a=i.current)==null?void 0:a.contains)!=null&&x.call(a,t.target)||(U=(M=k.current)==null?void 0:M.contains)!=null&&U.call(M,t.target)||v({type:1})))},!0),Pe([s,b],(t,a)=>{v({type:1}),me(a,Se.Loose)||(t.preventDefault(),s==null||s.focus())},f===0);let c=y(t=>{v({type:1});let a=(()=>t?t instanceof HTMLElement?t:"current"in t&&t.current instanceof HTMLElement?t.current:s:s)();a==null||a.focus()}),I=u.useMemo(()=>({close:c,isPortalled:S}),[c,S]),P=u.useMemo(()=>({open:f===0,close:c}),[f,c]),F=e,o={ref:$};return C.createElement(Q.Provider,{value:null},C.createElement(ne.Provider,{value:r},C.createElement(re.Provider,{value:I},C.createElement(be,{value:N(f,{[0]:K.Open,[1]:K.Closed})},q({ourProps:o,theirProps:F,slot:P,defaultTag:Ce,name:"Popover"})))))}let Fe="button";function we(e,n){let p=A(),{id:m=`headlessui-popover-button-${p}`,...$}=e,[l,r]=J("Popover.Button"),{isPortalled:f}=oe("Popover.Button"),s=u.useRef(null),h=`headlessui-focus-sentinel-${A()}`,b=pe(),E=b==null?void 0:b.closeOthers,i=he()!==null;u.useEffect(()=>{if(!i)return r({type:3,buttonId:m}),()=>{r({type:3,buttonId:null})}},[i,m,r]);let[k]=u.useState(()=>Symbol()),v=j(s,n,i?null:o=>{if(o)l.buttons.current.push(k);else{let t=l.buttons.current.indexOf(k);t!==-1&&l.buttons.current.splice(t,1)}l.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),o&&r({type:2,button:o})}),d=j(s,n),S=ee(s),g=y(o=>{var t,a,x;if(i){if(l.popoverState===1)return;switch(o.key){case L.Space:case L.Enter:o.preventDefault(),(a=(t=o.target).click)==null||a.call(t),r({type:1}),(x=l.button)==null||x.focus();break}}else switch(o.key){case L.Space:case L.Enter:o.preventDefault(),o.stopPropagation(),l.popoverState===1&&(E==null||E(l.buttonId)),r({type:0});break;case L.Escape:if(l.popoverState!==0)return E==null?void 0:E(l.buttonId);if(!s.current||S!=null&&S.activeElement&&!s.current.contains(S.activeElement))return;o.preventDefault(),o.stopPropagation(),r({type:1});break}}),w=y(o=>{i||o.key===L.Space&&o.preventDefault()}),T=y(o=>{var t,a;ce(o.currentTarget)||e.disabled||(i?(r({type:1}),(t=l.button)==null||t.focus()):(o.preventDefault(),o.stopPropagation(),l.popoverState===1&&(E==null||E(l.buttonId)),r({type:0}),(a=l.button)==null||a.focus()))}),B=y(o=>{o.preventDefault(),o.stopPropagation()}),O=l.popoverState===0,H=u.useMemo(()=>({open:O}),[O]),c=Ee(e,s),I=i?{ref:d,type:c,onKeyDown:g,onClick:T}:{ref:v,id:l.buttonId,type:c,"aria-expanded":e.disabled?void 0:l.popoverState===0,"aria-controls":l.panel?l.panelId:void 0,onKeyDown:g,onKeyUp:w,onClick:T,onMouseDown:B},P=se(),F=y(()=>{let o=l.panel;if(!o)return;function t(){N(P.current,{[D.Forwards]:()=>G(o,R.First),[D.Backwards]:()=>G(o,R.Last)})===z.Error&&G(te().filter(a=>a.dataset.headlessuiFocusGuard!=="true"),N(P.current,{[D.Forwards]:R.Next,[D.Backwards]:R.Previous}),{relativeTo:l.button})}t()});return C.createElement(C.Fragment,null,q({ourProps:I,theirProps:$,slot:H,defaultTag:Fe,name:"Popover.Button"}),O&&!i&&f&&C.createElement(Z,{id:h,features:_.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:F}))}let Be="div",Oe=X.RenderStrategy|X.Static;function ke(e,n){let p=A(),{id:m=`headlessui-popover-overlay-${p}`,...$}=e,[{popoverState:l},r]=J("Popover.Overlay"),f=j(n),s=ie(),h=(()=>s!==null?(s&K.Open)===K.Open:l===0)(),b=y(i=>{if(ce(i.currentTarget))return i.preventDefault();r({type:1})}),E=u.useMemo(()=>({open:l===0}),[l]);return q({ourProps:{ref:f,id:m,"aria-hidden":!0,onClick:b},theirProps:$,slot:E,defaultTag:Be,features:Oe,visible:h,name:"Popover.Overlay"})}let Me="div",Re=X.RenderStrategy|X.Static;function De(e,n){let p=A(),{id:m=`headlessui-popover-panel-${p}`,focus:$=!1,...l}=e,[r,f]=J("Popover.Panel"),{close:s,isPortalled:h}=oe("Popover.Panel"),b=`headlessui-focus-sentinel-before-${A()}`,E=`headlessui-focus-sentinel-after-${A()}`,i=u.useRef(null),k=j(i,n,c=>{f({type:4,panel:c})}),v=ee(i);Y(()=>(f({type:5,panelId:m}),()=>{f({type:5,panelId:null})}),[m,f]);let d=ie(),S=(()=>d!==null?(d&K.Open)===K.Open:r.popoverState===0)(),g=y(c=>{var I;switch(c.key){case L.Escape:if(r.popoverState!==0||!i.current||v!=null&&v.activeElement&&!i.current.contains(v.activeElement))return;c.preventDefault(),c.stopPropagation(),f({type:1}),(I=r.button)==null||I.focus();break}});u.useEffect(()=>{var c;e.static||r.popoverState===1&&((c=e.unmount)==null||c)&&f({type:4,panel:null})},[r.popoverState,e.unmount,e.static,f]),u.useEffect(()=>{if(!$||r.popoverState!==0||!i.current)return;let c=v==null?void 0:v.activeElement;i.current.contains(c)||G(i.current,R.First)},[$,i,r.popoverState]);let w=u.useMemo(()=>({open:r.popoverState===0,close:s}),[r,s]),T={ref:k,id:m,onKeyDown:g,onBlur:$&&r.popoverState===0?c=>{var I,P,F,o,t;let a=c.relatedTarget;a&&i.current&&((I=i.current)!=null&&I.contains(a)||(f({type:1}),((F=(P=r.beforePanelSentinel.current)==null?void 0:P.contains)!=null&&F.call(P,a)||(t=(o=r.afterPanelSentinel.current)==null?void 0:o.contains)!=null&&t.call(o,a))&&a.focus({preventScroll:!0})))}:void 0,tabIndex:-1},B=se(),O=y(()=>{let c=i.current;if(!c)return;function I(){N(B.current,{[D.Forwards]:()=>{var P;G(c,R.First)===z.Error&&((P=r.afterPanelSentinel.current)==null||P.focus())},[D.Backwards]:()=>{var P;(P=r.button)==null||P.focus({preventScroll:!0})}})}I()}),H=y(()=>{let c=i.current;if(!c)return;function I(){N(B.current,{[D.Forwards]:()=>{var P;if(!r.button)return;let F=te(),o=F.indexOf(r.button),t=F.slice(0,o+1),a=[...F.slice(o+1),...t];for(let x of a.slice())if(x.dataset.headlessuiFocusGuard==="true"||(P=r.panel)!=null&&P.contains(x)){let M=a.indexOf(x);M!==-1&&a.splice(M,1)}G(a,R.First,{sorted:!1})},[D.Backwards]:()=>{var P;G(c,R.Previous)===z.Error&&((P=r.button)==null||P.focus())}})}I()});return C.createElement(Q.Provider,{value:m},S&&h&&C.createElement(Z,{id:b,ref:r.beforePanelSentinel,features:_.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:O}),q({ourProps:T,theirProps:l,slot:w,defaultTag:Me,features:Re,visible:S,name:"Popover.Panel"}),S&&h&&C.createElement(Z,{id:E,ref:r.afterPanelSentinel,features:_.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:H}))}let Le="div";function Ge(e,n){let p=u.useRef(null),m=j(p,n),[$,l]=u.useState([]),r=y(v=>{l(d=>{let S=d.indexOf(v);if(S!==-1){let g=d.slice();return g.splice(S,1),g}return d})}),f=y(v=>(l(d=>[...d,v]),()=>r(v))),s=y(()=>{var v;let d=ye(p);if(!d)return!1;let S=d.activeElement;return(v=p.current)!=null&&v.contains(S)?!0:$.some(g=>{var w,T;return((w=d.getElementById(g.buttonId.current))==null?void 0:w.contains(S))||((T=d.getElementById(g.panelId.current))==null?void 0:T.contains(S))})}),h=y(v=>{for(let d of $)d.buttonId.current!==v&&d.close()}),b=u.useMemo(()=>({registerPopover:f,unregisterPopover:r,isFocusWithinPopoverGroup:s,closeOthers:h}),[f,r,s,h]),E=u.useMemo(()=>({}),[]),i=e,k={ref:m};return C.createElement(le.Provider,{value:b},q({ourProps:k,theirProps:i,slot:E,defaultTag:Le,name:"Popover.Group"}))}let Ne=W(Te),Ae=W(we),je=W(ke),Ke=W(De),He=W(Ge),Ue=Object.assign(Ne,{Button:Ae,Overlay:je,Panel:Ke,Group:He});export{Ue as L,Ee as s};
