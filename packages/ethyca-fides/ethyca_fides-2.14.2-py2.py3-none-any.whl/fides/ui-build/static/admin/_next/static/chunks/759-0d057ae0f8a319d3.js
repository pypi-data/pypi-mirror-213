"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{51471:function(e,t,n){n.d(t,{Z:function(){return f}});var s=n(34896),i=n(88038),r=n.n(i),a=n(86677),o=(n(27378),n(90768)),l=n(35100),c=n(64989),d=n(48114),u=n(51365),p=n(29549),m=n(60709),y=n(24246),h=function(){var e=(0,a.useRouter)();return(0,y.jsx)(s.xu,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,y.jsxs)(s.xu,{children:[(0,y.jsxs)(s.Kq,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,y.jsx)(s.xv,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,y.jsx)(p.zx,{size:"sm",variant:"outline",onClick:function(){e.push(m.fz)},children:"Configure"})]}),(0,y.jsxs)(s.xv,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},f=function(e){var t=e.children,n=e.title,i=(0,o.hz)(),p=(0,a.useRouter)(),m="/privacy-requests"===p.pathname||"/datastore-connection"===p.pathname,f=!(i.flags.privacyRequestsConfiguration&&m),x=(0,u.JE)(void 0,{skip:f}).data,g=(0,u.PW)(void 0,{skip:f}).data,j=i.flags.privacyRequestsConfiguration&&(!x||!g)&&m;return(0,y.jsxs)(s.kC,{"data-testid":n,direction:"column",children:[(0,y.jsxs)(r(),{children:[(0,y.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,y.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,y.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,y.jsx)(l.Z,{}),(0,y.jsx)(d.Z,{}),(0,y.jsxs)(s.kC,{as:"main",flexGrow:1,padding:10,gap:10,children:[(0,y.jsx)(s.xu,{flex:0,flexShrink:0,children:(0,y.jsx)(c.U,{})}),(0,y.jsxs)(s.kC,{direction:"column",flex:1,minWidth:0,children:[j?(0,y.jsx)(h,{}):null,t]})]})]})}},47119:function(e,t,n){n.d(t,{H:function(){return s}});var s=[{label:"Yes",value:"true"},{label:"No",value:"false"}]},36767:function(e,t,n){n.d(t,{Y:function(){return a}});var s=n(31318),i=n(32712);s.registerLocale(i);var r=s.getNames("en",{select:"official"}),a=Object.keys(r).map((function(e){return{value:s.alpha2ToAlpha3(e),label:r[e]}}))},12187:function(e,t,n){n.d(t,{V:function(){return r}});var s=n(90768),i=n(60709),r=function(){return{systemOrDatamapRoute:(0,s.hz)().plus?i.oG:i.So}}},16267:function(e,t,n){n.d(t,{Z:function(){return ne}});var s=n(90849),i=n(34896),r=n(29549),a=n(70409),o=n(89348),l=n(79894),c=n.n(l),d=n(86677),u=n(27378),p=n(6848),m=n(44204),y=n(12187),h=n(24753),f=n(90089),x=n(83125),g=n(48466),j=n(40397),v=n(66090),b=n(24246),_=["isLoading"];function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e){var t=e.system,n=(0,p.T)(),s=(0,j.f)({includeDatasets:!0}),r=s.isLoading,a=(0,f.Z)(s,_);return(0,b.jsxs)(i.Kq,{spacing:3,"data-testid":"privacy-declaration-step",children:[(0,b.jsx)(i.X6,{as:"h3",size:"md",children:"Data uses"}),(0,b.jsxs)(i.xv,{fontSize:"sm",children:["Data Uses describe the business purpose for which the personal data is processed or collected. Within a Data Use, you assign which categories of personal information are collected for this purpose and for which categories of data subjects. To update the available categories and uses, please visit"," ",(0,b.jsx)(c(),{href:"/taxonomy",passHref:!0,children:(0,b.jsx)(i.xv,{as:"a",color:"complimentary.600",children:"Manage taxonomy"})}),"."]}),r?(0,b.jsx)(x.$,{}):(0,b.jsx)(v.Z,O({system:t,onSave:function(e){n((0,g.db)(e))},includeCustomFields:!0},a))]})},S=n(51860),P=n(55732),D=n(97865),C=n(34707),q=n.n(C),A=n(34090),z=n(68301),Z=n(14275),T=n(43139),E=n(78624);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M={description:"",fides_key:"",name:"",organization_fides_key:n(41609).Av,tags:[],system_type:"",privacy_declarations:[],data_responsibility_title:void 0,administrating_department:"",third_country_transfers:[],system_dependencies:[],joint_controller:{name:"",email:"",address:"",phone:""},data_protection_impact_assessment:{is_required:"false",progress:"",link:""}},V=function(e){var t,n="true"===(null===(t=e.data_protection_impact_assessment)||void 0===t?void 0:t.is_required)?R(R({},e.data_protection_impact_assessment),{},{is_required:!0}):void 0,s=!!e.joint_controller&&!Object.values(e.joint_controller).every((function(e){return""===e}))?e.joint_controller:void 0;return{data_responsibility_title:e.data_responsibility_title,description:e.description,egress:e.egress,fides_key:e.fides_key,ingress:e.ingress,name:e.name,organization_fides_key:e.organization_fides_key,privacy_declarations:e.privacy_declarations,system_dependencies:e.system_dependencies,system_type:e.system_type,tags:e.tags,third_country_transfers:e.third_country_transfers,data_protection_impact_assessment:n,joint_controller:s,administrating_department:""===e.administrating_department?void 0:e.administrating_department}},W=n(92975),Y=n(47119),I=n(36767),K=n(38687),L=n(21023),B=(0,E.MM)(L.y5),H=function(e){var t,n=e.values,s=(0,A.u6)().initialValues,r=(0,p.C)(S.cS),a=r?r.map((function(e){var t;return{label:null!==(t=e.name)&&void 0!==t?t:e.fides_key,value:e.fides_key}})):[];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.VT,{id:"tags",name:"tags",label:"System Tags",options:s.tags?s.tags.map((function(e){return{value:e,label:e}})):[],tooltip:"Provide one or more tags to group the system. Tags are important as they allow you to filter and group systems for reporting and later review. Tags provide tremendous value as you scale - imagine you have thousands of systems, you\u2019re going to thank us later for tagging!",isMulti:!0}),(0,b.jsx)(T.AP,{label:"System dependencies",name:"system_dependencies",tooltip:"A list of fides keys to model dependencies.",options:a,isMulti:!0}),(0,b.jsx)(T.AP,{label:"Data responsibility title",name:"data_responsibility_title",options:B,tooltip:"An attribute to describe the role of responsibility over the personal data, used when exporting to a data map",isMulti:!1}),(0,b.jsx)(T.j0,{label:"Administrating department",name:"administrating_department",tooltip:"An optional value to identify the owning department or group of the system within your organization"}),(0,b.jsx)(T.AP,{name:"third_country_transfers",label:"Geographic location",tooltip:"An optional array to identify any third countries where data is transited to. For consistency purposes, these fields are required to follow the Alpha-3 code set in ISO 3166-1",isSearchable:!0,options:I.Y,isMulti:!0}),(0,b.jsxs)(i.xu,{children:[(0,b.jsxs)(i.xu,{display:"flex",alignItems:"center",mb:4,children:[(0,b.jsx)(W.lX,{mb:0,children:"Joint controller"}),(0,b.jsx)(K.Z,{label:"Contact information if a Joint Controller exists"})]}),(0,b.jsxs)(i.Kq,{ml:8,children:[(0,b.jsx)(T.j0,{label:"Name",name:"joint_controller.name"}),(0,b.jsx)(T.j0,{label:"Address",name:"joint_controller.address"}),(0,b.jsx)(T.j0,{label:"Email",name:"joint_controller.email"}),(0,b.jsx)(T.j0,{label:"Phone",name:"joint_controller.phone"})]})]}),(0,b.jsxs)(i.xu,{children:[(0,b.jsxs)(i.xu,{display:"flex",alignItems:"center",mb:4,children:[(0,b.jsx)(W.lX,{mb:0,children:"Data protection impact assessment"}),(0,b.jsx)(K.Z,{label:"Contains information in regard to the data protection impact assessment exported on a data map or Record of Processing Activities (RoPA)."})]}),(0,b.jsxs)(i.Kq,{ml:8,children:[(0,b.jsx)(T.xt,{name:"data_protection_impact_assessment.is_required",label:"Is required",options:Y.H}),"true"===(null===(t=n.data_protection_impact_assessment)||void 0===t?void 0:t.is_required)?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.j0,{label:"Progress",name:"data_protection_impact_assessment.progress",tooltip:"The optional status of a Data Protection Impact Assessment. Returned on an exported data map or RoPA."}),(0,b.jsx)(T.j0,{label:"Link",name:"data_protection_impact_assessment.link",tooltip:"The optional link to the Data Protection Impact Assessment. Returned on an exported data map or RoPA."})]}):null]})]})]})},N=z.Ry().shape({name:z.Z_().required().label("System name"),fides_key:z.Z_().required().label("System key")}),U=function(e){var t,n=e.system,s=!n?"your new system":null!==(t=n.name)&&void 0!==t?t:"this system";return(0,b.jsxs)(i.X6,{as:"h3",size:"lg",children:["Describe ",s]})},X=function(e){var t=e.onSuccess,n=e.abridged,s=e.system,o=e.withHeader,l=e.children,c=(0,Z.mZ)({resourceType:L.P6.SYSTEM,resourceFidesKey:null===s||void 0===s?void 0:s.fides_key}),d=(0,u.useMemo)((function(){return s?function(e,t){var n=e.data_protection_impact_assessment;return R(R({},e),{},{data_protection_impact_assessment:R(R({},n),{},{is_required:null!==n&&void 0!==n&&n.is_required?"true":"false"}),customFieldValues:t})}(s,c.customFieldValues):M}),[s,c.customFieldValues]),m=(0,S.f7)(),y=(0,D.Z)(m,2),h=y[0],f=y[1],x=(0,S.qQ)(),g=(0,D.Z)(x,2),j=g[0],v=g[1],_=(0,p.C)(S.cS),w=(0,u.useMemo)((function(){return Boolean(s&&(null===_||void 0===_?void 0:_.some((function(e){return e.fides_key===(null===s||void 0===s?void 0:s.fides_key)}))))}),[s,_]),O=(0,a.pm)(),k=function(){var e=(0,P.Z)(q().mark((function e(n,s){var i,r,a;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=V(n),r=function(e){if((0,E.D4)(e)){var r=w?"editing":"creating",a=(0,E.e$)(e.error,"An unexpected error occurred while ".concat(r," the system. Please try again."));O({status:"error",description:a})}else O.closeAll(),s.resetForm({values:n}),t(i)},!w){e.next=8;break}return e.next=5,j(i);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,h(i);case 10:a=e.sent;case 11:return e.next=13,c.upsertCustomFields(n);case 13:r(a);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),C=v.isLoading||f.isLoading||c.isLoading;return(0,b.jsx)(A.J9,{initialValues:d,enableReinitialize:!0,onSubmit:k,validationSchema:N,children:function(e){var t=e.dirty,a=e.values,c=e.isValid;return(0,b.jsx)(A.l0,{children:(0,b.jsxs)(i.Kq,{spacing:6,children:[o?(0,b.jsx)(U,{system:s}):null,(0,b.jsx)(i.xv,{fontSize:"sm",children:"By providing a small amount of additional context for each system we can make reporting and understanding our tech stack much easier for everyone from engineering to legal teams. So let\u2019s do this now."}),(0,b.jsx)(i.X6,{as:"h4",size:"sm",children:"System details"}),(0,b.jsxs)(i.Kq,{spacing:4,children:[(0,b.jsxs)(i.Kq,{spacing:4,maxWidth:n?void 0:{base:"100%",lg:"50%"},children:[(0,b.jsx)(T.j0,{id:"name",name:"name",label:"System name",tooltip:"Give the system a unique, and relevant name for reporting purposes. e.g. \u201cEmail Data Warehouse\u201d",variant:"stacked"}),(0,b.jsx)(T.j0,{id:"fides_key",name:"fides_key",label:"System Fides key",disabled:w,tooltip:"A string token of your own invention that uniquely identifies this System. It's your responsibility to ensure that the value is unique across all of your System objects. The value may only contain alphanumeric characters, underscores, and hyphens. ([A-Za-z0-9_.-]).",variant:"stacked"}),(0,b.jsx)(T.j0,{id:"description",name:"description",label:"System description",tooltip:"If you wish you can provide a description which better explains the purpose of this system.",variant:"stacked"})]}),n?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.xu,{py:6,children:(0,b.jsx)(i.iz,{})}),(0,b.jsx)(H,{values:a})]}),w&&(0,b.jsx)(Z.uc,{resourceFidesKey:null===s||void 0===s?void 0:s.fides_key,resourceType:L.P6.SYSTEM})]}),(0,b.jsx)(i.xu,{children:(0,b.jsx)(r.zx,{type:"submit",variant:"primary",size:"sm",isDisabled:C||!t||!c,isLoading:C,"data-testid":"save-btn",children:"Save"})}),l]})})}})},G=n(21084),J=n(55447),$=function(e){var t=e.isUnmounting,n=e.onContinue,s=e.onCancel,r=(0,A.u6)().dirty,a=(0,G.qY)(),o=a.isOpen,l=a.onClose,c=a.onOpen;(0,u.useEffect)((function(){t&&r?c():n()}),[t,r,c,n]);return(0,b.jsx)(J.Z,{cancelButtonText:"Continue editing",continueButtonText:"Discard",isCentered:!0,isOpen:o,onClose:function(){s(),l()},onConfirm:n,title:"Unsaved changes",message:(0,b.jsx)(i.xv,{color:"gray.500",children:"You have unsaved changes, are you sure you want to discard?"})})};function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=function(e){var t=e.onViewDatamap,n=e.onAddPrivacyDeclaration,s={variant:"link",textDecor:"underline",textColor:"gray.700",fontWeight:"medium",display:"initial",cursor:"pointer"};return(0,b.jsxs)(i.xu,{children:[(0,b.jsx)(i.xv,{fontWeight:"700",children:"System has been saved successfully"}),(0,b.jsxs)(i.xv,{textColor:"gray.700",whiteSpace:"inherit",children:["Your system has been added to your data map. You can"," ",(0,b.jsx)(r.zx,ee(ee({as:"a",onClick:t},s),{},{whiteSpace:"inherit",children:"view it now"}))," ","and come back to finish this setup when you\u2019re ready. Or you can progress to"," ",(0,b.jsx)(r.zx,ee(ee({as:"a",onClick:n},s),{},{whiteSpace:"inherit",children:"adding your privacy declarations in the next tab"})),"."]})]})},ne=function(e){var t=e.isCreate,n=(0,u.useState)(0),s=n[0],r=n[1],l=(0,u.useState)(void 0),f=l[0],x=l[1],g=(0,u.useState)(!1),j=g[0],v=g[1],_=(0,y.V)().systemOrDatamapRoute,w=(0,d.useRouter)(),O=(0,a.pm)(),P=(0,p.T)(),D=(0,p.C)(S.NC);(0,u.useEffect)((function(){return t&&P((0,S.db)(void 0)),function(){P((0,S.db)(void 0))}}),[P,t]);var C=[{label:"System information",content:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.xu,{px:6,mb:9,children:(0,b.jsx)(X,{onSuccess:function(e){void 0===D&&v(!0),P((0,S.db)(e));var t=ee(ee({},h.MA),{},{description:(0,b.jsx)(te,{onViewDatamap:function(){w.push(_).then((function(){O.closeAll()}))},onAddPrivacyDeclaration:function(){r(1),O.closeAll()}})});O(ee({},t))},system:D,abridged:t,children:(0,b.jsx)($,{isUnmounting:void 0!==f,onContinue:function(){f&&(r(f),x(void 0))},onCancel:function(){return x(void 0)}})})}),j?(0,b.jsx)(i.xu,{backgroundColor:"gray.100",px:6,py:3,children:(0,b.jsxs)(i.xv,{color:"gray.500",fontSize:"sm","data-testid":"save-help-message",children:["Now that you have saved this new system it is"," ",(0,b.jsx)(c(),{href:_,passHref:!0,children:(0,b.jsx)(i.xv,{as:"a",textDecor:"underline",children:"ready to view in your data map"})}),". You can return to this setup at any time to add privacy declarations to this system."]})}):null]})},{label:"Data uses",content:D?(0,b.jsx)(i.xu,{px:6,width:{base:"100%",lg:"70%"},children:(0,b.jsx)(k,{system:D})}):null,isDisabled:!D},{label:"Data flow",content:D?(0,b.jsxs)(i.xu,{width:{base:"100%",lg:"70%"},children:[(0,b.jsxs)(i.xu,{px:6,paddingBottom:2,children:[(0,b.jsx)(i.xv,{fontSize:"md",lineHeight:6,fontWeight:"bold",marginBottom:3,children:"Data flow"}),(0,b.jsx)(i.xv,{fontSize:"sm",lineHeight:5,fontWeight:"medium",children:"Data flow describes the flow of data between systems in your Data Map. Below, you can configure Source and Destination systems and the corresponding links will be drawn in the Data Map graph. Source systems are systems that send data to this system while Destination systems receive data from this system."})]}),(0,b.jsx)(o.q,{system:D,isSystemTab:!0})]}):null,isDisabled:!D}];return(0,b.jsx)(m.Z,{data:C,"data-testid":"system-tabs",index:s,isLazy:!0,isManual:!0,onChange:function(e){0===e||1===e&&2===s||2===e&&1===s?r(e):x(e)}})}}}]);