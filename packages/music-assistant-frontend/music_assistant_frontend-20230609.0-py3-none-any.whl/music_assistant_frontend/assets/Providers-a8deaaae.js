import{l as K,I as Q,r as T,c as G,O as a,a7 as H,b as J,w as W,a2 as X,q as r,v as u,x as n,y as _,z as D,A as s,F as w,aE as V,j as i,L as l,N as d,k as M,K as g,M as v,Q as Y,_ as b,$ as y}from"./index-11e01e27.js";import{L as p,_ as S,V as P,B as k}from"./ProviderIcon.vue_vue_type_script_setup_true_lang-0ce5ab95.js";import{V as Z}from"./VContainer-b3bc5698.js";import{c as L}from"./VCard-4c75536f.js";import{V as x}from"./VToolbar-685b17bc.js";import{a as N,V as z}from"./VMenu-6f4b0d2a.js";import{l as ee,V as h}from"./VBtn-ba18d485.js";import{V as te}from"./index-688be463.js";import{V as ne}from"./VAlert-1abda951.js";/* empty css              */const ie={class:"line-clamp-1"},ae=l("br",null,null,-1),oe={class:"line-clamp-1"},se={class:"line-clamp-1"},re={class:"list-actions"},de={key:0},le={key:1},ce={key:2},ue={key:3},$e=K({__name:"Providers",setup(pe){const I=Q(),f=T([]),U=G(()=>Object.values(a.providerManifests).filter(t=>!t.hidden&&(t.multi_instance||!f.value.find(c=>c.domain==t.domain))).sort((t,c)=>(t.name||a.providerManifests[t.domain].name).toUpperCase()>(c.name||a.providerManifests[c.domain].name).toUpperCase()?1:-1)),R=a.subscribe(H.PROVIDERS_UPDATED,()=>{E()});J(R);const E=async function(){f.value=await a.getProviderConfigs()},A=function(t){a.removeProviderConfig(t),f.value=f.value.filter(c=>c.instance_id!=t)},B=function(t){I.push(`/settings/editprovider/${t}`)},O=function(t){I.push(`/settings/addprovider/${t.domain}`)},j=function(t){t.enabled=!t.enabled,a.saveProviderConfig(t.domain,{enabled:t.enabled},t.instance_id)},F=function(t){a.getData("config/providers/reload",{instance_id:t}).catch(c=>alert(c))};return W(()=>a.providers,t=>{t&&E()},{immediate:!0}),(t,c)=>{const q=X("hold");return r(),u(Z,null,{default:n(()=>[(r(!0),_(w,null,D(s(V),m=>(r(),u(L,{key:m,style:{"margin-bottom":"10px"}},{default:n(()=>[i(x,{color:"transparent",density:"compact",class:"titlebar"},{title:n(()=>[l("h2",ie,d(t.$t(`settings.${m}providers`)),1)]),append:n(()=>[U.value.filter(e=>e.type==m).length?(r(),u(N,{key:0},{activator:n(({props:e})=>[i(ee,M({variant:"text"},e),{default:n(()=>[g(d(t.$t("settings.add_new")),1)]),_:2},1040)]),default:n(()=>[i(L,{density:"compact"},{default:n(()=>[(r(!0),_(w,null,D(U.value.filter(e=>e.type==m),e=>(r(),u(p,{key:e.domain,density:"compact",style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:e.name,onClick:C=>O(e)},{prepend:n(()=>[i(S,{domain:e.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:2},1024)]),_:2},1024)):v("",!0)]),_:2},1024),i(te),m==s(V).MUSIC&&f.value.filter(e=>e.type==s(V).MUSIC&&e.domain in s(a).providerManifests&&!s(a).providerManifests[e.domain].hidden).length==0?(r(),u(ne,{key:0,color:"primary",theme:"dark",icon:"mdi-radio-tower",prominent:"",style:{"margin-bottom":"15px"}},{default:n(()=>[l("b",null,d(t.$t("settings.no_providers")),1),ae,g(" "+d(t.$t("settings.no_providers_detail")),1)]),_:1})):v("",!0),i(z,null,{default:n(()=>[(r(!0),_(w,null,D(f.value.filter(e=>e.type==m),e=>Y((r(),u(p,{link:"",density:"compact",onClick:C=>B(e.instance_id),key:e.instance_id},{prepend:n(()=>[i(S,{domain:e.domain,size:"40px",class:"listitem-media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),title:n(()=>[l("div",oe,d(e.name||s(a).providerManifests[e.domain].name),1)]),subtitle:n(()=>[l("div",se,d(s(a).providerManifests[e.domain].description),1)]),append:n(()=>{var C;return[l("div",re,[s(a).syncTasks.value.filter(o=>o.provider_instance==e.instance_id).length>0?(r(),_("div",de,[i(P,{location:"top end",origin:"end center"},{activator:n(({props:o})=>[i(k,b(y(o)),{default:n(()=>[i(h,M(o,{color:"grey"}),{default:n(()=>[g(" mdi-sync ")]),_:2},1040)]),_:2},1040)]),default:n(()=>[l("span",null,d(t.$t("settings.sync_running")),1)]),_:1})])):v("",!0),e.enabled?e.last_error?(r(),_("div",ce,[i(P,{location:"top end",origin:"end center"},{activator:n(({props:o})=>[i(k,b(y(o)),{default:n(()=>[i(h,M(o,{color:"red"}),{default:n(()=>[g(" mdi-alert-circle ")]),_:2},1040)]),_:2},1040)]),default:n(()=>[l("span",null,d(e.last_error),1)]),_:2},1024)])):(C=s(a).providers[e.instance_id])!=null&&C.available?v("",!0):(r(),_("div",ue,[i(P,{location:"top end",origin:"end center"},{activator:n(({props:o})=>[i(k,b(y(o)),{default:n(()=>[i(h,{icon:"mdi-timer-sand"})]),_:2},1040)]),default:n(()=>[l("span",null,d(t.$t("settings.not_loaded")),1)]),_:1})])):(r(),_("div",le,[i(P,{location:"top end",origin:"end center"},{activator:n(({props:o})=>[i(k,b(y(o)),{default:n(()=>[i(h,M(o,{color:"grey"}),{default:n(()=>[g(" mdi-cancel ")]),_:2},1040)]),_:2},1040)]),default:n(()=>[l("span",null,d(t.$t("settings.provider_disabled")),1)]),_:1})])),i(N,{location:"bottom end"},{activator:n(({props:o})=>[i(k,b(y(o)),{default:n(()=>[i(h,{icon:"mdi-dots-vertical"})]),_:2},1040)]),default:n(()=>[i(z,null,{default:n(()=>{var o;return[i(p,{title:t.$t("settings.configure"),"prepend-icon":"mdi-cog",onClick:$=>B(e.instance_id)},null,8,["title","onClick"]),i(p,{title:e.enabled?t.$t("settings.disable"):t.$t("settings.enable"),"prepend-icon":"mdi-cancel",disabled:s(a).providerManifests[e.domain].builtin,onClick:$=>j(e)},null,8,["title","disabled","onClick"]),s(a).providerManifests[e.domain].documentation?(r(),u(p,{key:0,title:t.$t("settings.documentation"),"prepend-icon":"mdi-bookshelf",href:s(a).providerManifests[e.domain].documentation,target:"_blank"},null,8,["title","href"])):v("",!0),(o=s(a).providers[e.instance_id])!=null&&o.available&&m==s(V).MUSIC?(r(),u(p,{key:1,title:t.$t("settings.sync"),"prepend-icon":"mdi-sync",onClick:$=>s(a).startSync(void 0,[e.instance_id])},null,8,["title","onClick"])):v("",!0),!s(a).providerManifests[e.domain].builtin&&!s(a).providerManifests[e.domain].load_by_default?(r(),u(p,{key:2,title:t.$t("settings.delete"),"prepend-icon":"mdi-delete",onClick:$=>A(e.instance_id)},null,8,["title","onClick"])):v("",!0),i(p,{title:t.$t("settings.reload"),"prepend-icon":"mdi-refresh",onClick:$=>F(e.instance_id)},null,8,["title","onClick"])]}),_:2},1024)]),_:2},1024)])]}),_:2},1032,["onClick"])),[[q,()=>{B(e.instance_id)}]])),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})}}});export{$e as default};
