import{a as H,b as ue}from"./chunk-O5UGFU32.js";import"./chunk-NLMHZ7JJ.js";function ee(i){return i.split("-")[1]}function me(i){return i==="y"?"height":"width"}function $(i){return i.split("-")[0]}function te(i){return["top","bottom"].includes($(i))?"x":"y"}function pe(i,r,e){let{reference:t,floating:a}=i,n=t.x+t.width/2-a.width/2,s=t.y+t.height/2-a.height/2,o=te(r),l=me(o),c=t[l]/2-a[l]/2,h=o==="x",d;switch($(r)){case"top":d={x:n,y:t.y-a.height};break;case"bottom":d={x:n,y:t.y+t.height};break;case"right":d={x:t.x+t.width,y:s};break;case"left":d={x:t.x-a.width,y:s};break;default:d={x:t.x,y:t.y}}switch(ee(r)){case"start":d[o]-=c*(e&&h?-1:1);break;case"end":d[o]+=c*(e&&h?-1:1)}return d}var ge=async(i,r,e)=>{let{placement:t="bottom",strategy:a="absolute",middleware:n=[],platform:s}=e,o=n.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(r)),c=await s.getElementRects({reference:i,floating:r,strategy:a}),{x:h,y:d}=pe(c,t,l),p=t,u={},m=0;for(let f=0;f<o.length;f++){let{name:g,fn:w}=o[f],{x:y,y:M,data:T,reset:D}=await w({x:h,y:d,initialPlacement:t,placement:p,strategy:a,middlewareData:u,rects:c,platform:s,elements:{reference:i,floating:r}});h=y??h,d=M??d,u={...u,[g]:{...u[g],...T}},D&&m<=50&&(m++,typeof D=="object"&&(D.placement&&(p=D.placement),D.rects&&(c=D.rects===!0?await s.getElementRects({reference:i,floating:r,strategy:a}):D.rects),{x:h,y:d}=pe(c,p,l)),f=-1)}return{x:h,y:d,placement:p,strategy:a,middlewareData:u}};function Fe(i){return typeof i!="number"?function(r){return{top:0,right:0,bottom:0,left:0,...r}}(i):{top:i,right:i,bottom:i,left:i}}function B(i){return{...i,top:i.y,left:i.x,right:i.x+i.width,bottom:i.y+i.height}}async function ie(i,r){var e;r===void 0&&(r={});let{x:t,y:a,platform:n,rects:s,elements:o,strategy:l}=i,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:d="floating",altBoundary:p=!1,padding:u=0}=r,m=Fe(u),f=o[p?d==="floating"?"reference":"floating":d],g=B(await n.getClippingRect({element:(e=await(n.isElement==null?void 0:n.isElement(f)))==null||e?f:f.contextElement||await(n.getDocumentElement==null?void 0:n.getDocumentElement(o.floating)),boundary:c,rootBoundary:h,strategy:l})),w=d==="floating"?{...s.floating,x:t,y:a}:s.reference,y=await(n.getOffsetParent==null?void 0:n.getOffsetParent(o.floating)),M=await(n.isElement==null?void 0:n.isElement(y))&&await(n.getScale==null?void 0:n.getScale(y))||{x:1,y:1},T=B(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({rect:w,offsetParent:y,strategy:l}):w);return{top:(g.top-T.top+m.top)/M.y,bottom:(T.bottom-g.bottom+m.bottom)/M.y,left:(g.left-T.left+m.left)/M.x,right:(T.right-g.right+m.right)/M.x}}var qe=Math.min,We=Math.max;function fe(i,r,e){return We(i,qe(r,e))}var Be=["top","right","bottom","left"],_e=Be.reduce((i,r)=>i.concat(r,r+"-start",r+"-end"),[]),Ye={left:"right",right:"left",bottom:"top",top:"bottom"};function Z(i){return i.replace(/left|right|bottom|top/g,r=>Ye[r])}function ze(i,r,e){e===void 0&&(e=!1);let t=ee(i),a=te(i),n=me(a),s=a==="x"?t===(e?"end":"start")?"right":"left":t==="start"?"bottom":"top";return r.reference[n]>r.floating[n]&&(s=Z(s)),{main:s,cross:Z(s)}}var Ne={start:"end",end:"start"};function Q(i){return i.replace(/start|end/g,r=>Ne[r])}var ne=function(i){return i===void 0&&(i={}),{name:"flip",options:i,async fn(r){var e;let{placement:t,middlewareData:a,rects:n,initialPlacement:s,platform:o,elements:l}=r,{mainAxis:c=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:m=!0,...f}=i,g=$(t),w=$(s)===s,y=await(o.isRTL==null?void 0:o.isRTL(l.floating)),M=d||(w||!m?[Z(s)]:function(x){let R=Z(x);return[Q(x),R,Q(R)]}(s));d||u==="none"||M.push(...function(x,R,V,L){let j=ee(x),E=function(W,J,$e){let de=["left","right"],he=["right","left"],Ie=["top","bottom"],Pe=["bottom","top"];switch(W){case"top":case"bottom":return $e?J?he:de:J?de:he;case"left":case"right":return J?Ie:Pe;default:return[]}}($(x),V==="start",L);return j&&(E=E.map(W=>W+"-"+j),R&&(E=E.concat(E.map(Q)))),E}(s,m,u,y));let T=[s,...M],D=await ie(r,f),U=[],q=((e=a.flip)==null?void 0:e.overflows)||[];if(c&&U.push(D[g]),h){let{main:x,cross:R}=ze(t,n,y);U.push(D[x],D[R])}if(q=[...q,{placement:t,overflows:U}],!U.every(x=>x<=0)){var oe,le;let x=(((oe=a.flip)==null?void 0:oe.index)||0)+1,R=T[x];if(R)return{data:{index:x,overflows:q},reset:{placement:R}};let V=(le=q.filter(L=>L.overflows[0]<=0).sort((L,j)=>L.overflows[1]-j.overflows[1])[0])==null?void 0:le.placement;if(!V)switch(p){case"bestFit":{var ce;let L=(ce=q.map(j=>[j.placement,j.overflows.filter(E=>E>0).reduce((E,W)=>E+W,0)]).sort((j,E)=>j[1]-E[1])[0])==null?void 0:ce[0];L&&(V=L);break}case"initialPlacement":V=s}if(t!==V)return{reset:{placement:V}}}return{}}}};function Ue(i){return i==="x"?"y":"x"}var ae=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(r){let{x:e,y:t,placement:a}=r,{mainAxis:n=!0,crossAxis:s=!1,limiter:o={fn:g=>{let{x:w,y}=g;return{x:w,y}}},...l}=i,c={x:e,y:t},h=await ie(r,l),d=te($(a)),p=Ue(d),u=c[d],m=c[p];if(n){let g=d==="y"?"bottom":"right";u=fe(u+h[d==="y"?"top":"left"],u,u-h[g])}if(s){let g=p==="y"?"bottom":"right";m=fe(m+h[p==="y"?"top":"left"],m,m-h[g])}let f=o.fn({...r,[d]:u,[p]:m});return{...f,data:{x:f.x-e,y:f.y-t}}}}};function b(i){var r;return((r=i.ownerDocument)==null?void 0:r.defaultView)||window}function k(i){return b(i).getComputedStyle(i)}function De(i){return i instanceof b(i).Node}function C(i){return De(i)?(i.nodeName||"").toLowerCase():""}function S(i){return i instanceof b(i).HTMLElement}function v(i){return i instanceof b(i).Element}function we(i){return typeof ShadowRoot>"u"?!1:i instanceof b(i).ShadowRoot||i instanceof ShadowRoot}function N(i){let{overflow:r,overflowX:e,overflowY:t,display:a}=k(i);return/auto|scroll|overlay|hidden|clip/.test(r+t+e)&&!["inline","contents"].includes(a)}function Ze(i){return["table","td","th"].includes(C(i))}function se(i){let r=re(),e=k(i);return e.transform!=="none"||e.perspective!=="none"||!r&&!!e.backdropFilter&&e.backdropFilter!=="none"||!r&&!!e.filter&&e.filter!=="none"||["transform","perspective","filter"].some(t=>(e.willChange||"").includes(t))||["paint","layout","strict","content"].some(t=>(e.contain||"").includes(t))}function re(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function K(i){return["html","body","#document"].includes(C(i))}var ye=Math.min,Y=Math.max,G=Math.round;function ke(i){let r=k(i),e=parseFloat(r.width)||0,t=parseFloat(r.height)||0,a=S(i),n=a?i.offsetWidth:e,s=a?i.offsetHeight:t,o=G(e)!==n||G(t)!==s;return o&&(e=n,t=s),{width:e,height:t,fallback:o}}function Se(i){return v(i)?i:i.contextElement}var Me={x:1,y:1};function I(i){let r=Se(i);if(!S(r))return Me;let e=r.getBoundingClientRect(),{width:t,height:a,fallback:n}=ke(r),s=(n?G(e.width):e.width)/t,o=(n?G(e.height):e.height)/a;return s&&Number.isFinite(s)||(s=1),o&&Number.isFinite(o)||(o=1),{x:s,y:o}}var ve={x:0,y:0};function Re(i,r,e){var t,a;if(r===void 0&&(r=!0),!re())return ve;let n=i?b(i):window;return!e||r&&e!==n?ve:{x:((t=n.visualViewport)==null?void 0:t.offsetLeft)||0,y:((a=n.visualViewport)==null?void 0:a.offsetTop)||0}}function O(i,r,e,t){r===void 0&&(r=!1),e===void 0&&(e=!1);let a=i.getBoundingClientRect(),n=Se(i),s=Me;r&&(t?v(t)&&(s=I(t)):s=I(i));let o=Re(n,e,t),l=(a.left+o.x)/s.x,c=(a.top+o.y)/s.y,h=a.width/s.x,d=a.height/s.y;if(n){let p=b(n),u=t&&v(t)?b(t):t,m=p.frameElement;for(;m&&t&&u!==p;){let f=I(m),g=m.getBoundingClientRect(),w=getComputedStyle(m);g.x+=(m.clientLeft+parseFloat(w.paddingLeft))*f.x,g.y+=(m.clientTop+parseFloat(w.paddingTop))*f.y,l*=f.x,c*=f.y,h*=f.x,d*=f.y,l+=g.x,c+=g.y,m=b(m).frameElement}}return B({width:h,height:d,x:l,y:c})}function A(i){return((De(i)?i.ownerDocument:i.document)||window.document).documentElement}function X(i){return v(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.pageXOffset,scrollTop:i.pageYOffset}}function je(i){return O(A(i)).left+X(i).scrollLeft}function P(i){if(C(i)==="html")return i;let r=i.assignedSlot||i.parentNode||we(i)&&i.host||A(i);return we(r)?r.host:r}function Te(i){let r=P(i);return K(r)?r.ownerDocument.body:S(r)&&N(r)?r:Te(r)}function z(i,r){var e;r===void 0&&(r=[]);let t=Te(i),a=t===((e=i.ownerDocument)==null?void 0:e.body),n=b(t);return a?r.concat(n,n.visualViewport||[],N(t)?t:[]):r.concat(t,z(t))}function xe(i,r,e){let t;if(r==="viewport")t=function(a,n){let s=b(a),o=A(a),l=s.visualViewport,c=o.clientWidth,h=o.clientHeight,d=0,p=0;if(l){c=l.width,h=l.height;let u=re();(!u||u&&n==="fixed")&&(d=l.offsetLeft,p=l.offsetTop)}return{width:c,height:h,x:d,y:p}}(i,e);else if(r==="document")t=function(a){let n=A(a),s=X(a),o=a.ownerDocument.body,l=Y(n.scrollWidth,n.clientWidth,o.scrollWidth,o.clientWidth),c=Y(n.scrollHeight,n.clientHeight,o.scrollHeight,o.clientHeight),h=-s.scrollLeft+je(a),d=-s.scrollTop;return k(o).direction==="rtl"&&(h+=Y(n.clientWidth,o.clientWidth)-l),{width:l,height:c,x:h,y:d}}(A(i));else if(v(r))t=function(a,n){let s=O(a,!0,n==="fixed"),o=s.top+a.clientTop,l=s.left+a.clientLeft,c=S(a)?I(a):{x:1,y:1};return{width:a.clientWidth*c.x,height:a.clientHeight*c.y,x:l*c.x,y:o*c.y}}(r,e);else{let a=Re(i);t={...r,x:r.x-a.x,y:r.y-a.y}}return B(t)}function Le(i,r){let e=P(i);return!(e===r||!v(e)||K(e))&&(k(e).position==="fixed"||Le(e,r))}function Ee(i,r){return S(i)&&k(i).position!=="fixed"?r?r(i):i.offsetParent:null}function be(i,r){let e=b(i);if(!S(i))return e;let t=Ee(i,r);for(;t&&Ze(t)&&k(t).position==="static";)t=Ee(t,r);return t&&(C(t)==="html"||C(t)==="body"&&k(t).position==="static"&&!se(t))?e:t||function(a){let n=P(a);for(;S(n)&&!K(n);){if(se(n))return n;n=P(n)}return null}(i)||e}function Ge(i,r,e){let t=S(r),a=A(r),n=e==="fixed",s=O(i,!0,n,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};if(t||!t&&!n)if((C(r)!=="body"||N(a))&&(o=X(r)),S(r)){let c=O(r,!0,n,r);l.x=c.x+r.clientLeft,l.y=c.y+r.clientTop}else a&&(l.x=je(a));return{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}var Ke={getClippingRect:function(i){let{element:r,boundary:e,rootBoundary:t,strategy:a}=i,n=e==="clippingAncestors"?function(c,h){let d=h.get(c);if(d)return d;let p=z(c).filter(g=>v(g)&&C(g)!=="body"),u=null,m=k(c).position==="fixed",f=m?P(c):c;for(;v(f)&&!K(f);){let g=k(f),w=se(f);w||g.position!=="fixed"||(u=null),(m?!w&&!u:!w&&g.position==="static"&&u&&["absolute","fixed"].includes(u.position)||N(f)&&!w&&Le(c,f))?p=p.filter(y=>y!==f):u=g,f=P(f)}return h.set(c,p),p}(r,this._c):[].concat(e),s=[...n,t],o=s[0],l=s.reduce((c,h)=>{let d=xe(r,h,a);return c.top=Y(d.top,c.top),c.right=ye(d.right,c.right),c.bottom=ye(d.bottom,c.bottom),c.left=Y(d.left,c.left),c},xe(r,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(i){let{rect:r,offsetParent:e,strategy:t}=i,a=S(e),n=A(e);if(e===n)return r;let s={scrollLeft:0,scrollTop:0},o={x:1,y:1},l={x:0,y:0};if((a||!a&&t!=="fixed")&&((C(e)!=="body"||N(n))&&(s=X(e)),S(e))){let c=O(e);o=I(e),l.x=c.x+e.clientLeft,l.y=c.y+e.clientTop}return{width:r.width*o.x,height:r.height*o.y,x:r.x*o.x-s.scrollLeft*o.x+l.x,y:r.y*o.y-s.scrollTop*o.y+l.y}},isElement:v,getDimensions:function(i){return ke(i)},getOffsetParent:be,getDocumentElement:A,getScale:I,async getElementRects(i){let{reference:r,floating:e,strategy:t}=i,a=this.getOffsetParent||be,n=this.getDimensions;return{reference:Ge(r,await a(e),t),floating:{x:0,y:0,...await n(e)}}},getClientRects:i=>Array.from(i.getClientRects()),isRTL:i=>k(i).direction==="rtl"};function Ae(i,r,e,t){t===void 0&&(t={});let{ancestorScroll:a=!0,ancestorResize:n=!0,elementResize:s=!0,animationFrame:o=!1}=t,l=a||n?[...v(i)?z(i):i.contextElement?z(i.contextElement):[],...z(r)]:[];l.forEach(p=>{let u=!v(p)&&p.toString().includes("V");!a||o&&!u||p.addEventListener("scroll",e,{passive:!0}),n&&p.addEventListener("resize",e)});let c,h=null;s&&(h=new ResizeObserver(()=>{e()}),v(i)&&!o&&h.observe(i),v(i)||!i.contextElement||o||h.observe(i.contextElement),h.observe(r));let d=o?O(i):null;return o&&function p(){let u=O(i);!d||u.x===d.x&&u.y===d.y&&u.width===d.width&&u.height===d.height||e(),d=u,c=requestAnimationFrame(p)}(),e(),()=>{var p;l.forEach(u=>{a&&u.removeEventListener("scroll",e),n&&u.removeEventListener("resize",e)}),(p=h)==null||p.disconnect(),h=null,o&&cancelAnimationFrame(c)}}var Ce=(i,r,e)=>{let t=new Map,a={platform:Ke,...e},n={...a.platform,_c:t};return ge(i,r,{...a,platform:n})};var Ve=':is([is=django-datepicker],[is=django-datetimepicker]){--dummy-style: none}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar{box-shadow:#d3d3d3 0 0 1rem;width:max-content;position:absolute;top:0;left:0}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar [hidden]{display:none !important}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .controls{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #d3d3d3}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .controls button{display:inline-flex;background-color:rgba(0,0,0,0);border:none;padding:0;min-width:28px}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .controls button:hover{background-color:#f0f0f0}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .controls button>svg{margin:0 auto}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .controls time{width:10rem;text-align:center}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .controls.years-view time{opacity:.75}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges{--dummy-style: none}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul{list-style:none;margin:0;padding:0;text-align:center;display:grid;gap:2px}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.hours{grid-template-columns:repeat(6, 1fr)}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.hours>li.preselected{border:1px solid #d3d3d3;border-bottom-color:#fff;border-top-left-radius:5px;border-top-right-radius:5px}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.weekdays,:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.monthdays{grid-template-columns:repeat(7, 1fr)}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.monthdays>li.adjacent{color:#606060}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.months{grid-template-columns:repeat(3, 1fr)}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.years{grid-template-columns:repeat(4, 1fr)}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.weekdays{font-weight:bold}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul:not(.weekdays){--dummy-style: none}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul:not(.weekdays)>li{width:2em}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul:not(.weekdays)>li.selected{background-color:#009cff;color:#fff}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul:not(.weekdays)>li.selected.today::after{border-color:rgba(0,0,0,0) rgba(0,0,0,0) #fff rgba(0,0,0,0)}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul:not(.weekdays)>li[disabled]{opacity:.5}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul:not(.weekdays)>li:not([disabled]):hover{opacity:1;background-color:#f0f0f0;cursor:pointer}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.minutes{font-size:smaller;border:1px solid #d3d3d3;margin:-1px 0 3px;padding:0 5px;line-height:inherit}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul.minutes>li{width:inherit}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul>li.today{position:relative}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges ul>li.today::after{position:absolute;content:"";bottom:0;right:0;border-style:solid;border-width:0 0 10px 10px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) #009cff rgba(0,0,0,0)}:is([is=django-datepicker],[is=django-datetimepicker])+.dj-calendar .ranges abbr[title]{text-decoration:none}:is([is=django-datepicker],[is=django-datetimepicker])[aria-expanded=false]+.dj-calendar{display:none}:is([is=django-datepicker],[is=django-datetimepicker])[aria-expanded=true]+.dj-calendar{display:block}';var _=class extends ue{constructor(e,t){super(e);this.autoZeroRegExps=[];this.autoDelimiterRegExps=[];this.delimiter="-";this.isOpen=!1;this.handleClick=e=>{if(!this.isOpen)return;let t=e.target instanceof Element?e.target:null;for(;t;){if(t.isSameNode(this.calendarElement)||t.isSameNode(this.inputElement))return;t=t.parentElement}this.close(),this.inputElement.blur()};this.updatePosition=()=>{Ce(this.inputElement,this.calendarElement,{middleware:[ne(),ae()]}).then(({y:e})=>Object.assign(this.calendarElement.style,{top:`${e}px`}))};this.handleFocus=e=>{if(this.isOpen)return;this.calendarElement.parentElement.style.position="relative",this.cleanup=Ae(this.inputElement,this.calendarElement,this.updatePosition),this.inputElement.setAttribute("aria-expanded","true");let t=this.inputElement.value;this.inputElement.value=t.trimEnd(),this.inputElement.value!==t&&this.inputElement.dispatchEvent(new Event("input")),this.isOpen=!0};this.handleBlur=e=>{this.isOpen?this.inputElement.focus():this.validate()};this.handleInput=e=>{this.isOpen&&this.close(),e instanceof InputEvent&&e.inputType==="insertText"&&(this.inputElement.value=this.inputElement.value.replace("  "," ").replace(this.delimiter.concat(this.delimiter),this.delimiter).replace("::",":"),this.autoZeroRegExps.forEach(t=>{this.inputElement.value.match(t)&&(this.inputElement.value=this.inputElement.value.replace(t,"$10$2"))}),this.autoDelimiterRegExps.forEach(t=>{this.inputElement.value.match(t)&&(this.inputElement.value=this.inputElement.value.concat(this.delimiter))}),this.autoSpaceRegExp&&this.inputElement.value.match(this.autoSpaceRegExp)&&(this.inputElement.value=this.inputElement.value.concat(" ")),this.autoColonRegExp&&this.inputElement.value.match(this.autoColonRegExp)&&(this.inputElement.value=this.inputElement.value.concat(":")))};this.handleChange=e=>{let t=this.validate();t&&this.fetchCalendar(t,this.viewMode)};this.handleKeypress=async e=>{if(!this.isOpen)return;let t=null,a=new Map([["y","m"],["m","w"],["w","h"]]);switch(e.key){case"ArrowUp":await this.navigate(0);break;case"ArrowRight":await this.navigate(1);break;case"ArrowDown":await this.navigate(2);break;case"ArrowLeft":await this.navigate(3);break;case"Escape":this.close();break;case"Tab":this.close(),this.inputElement.blur();break;case"PageUp":t=this.calendarElement.querySelector("button.prev"),t&&await this.fetchCalendar(this.getDate(t),this.viewMode);break;case"PageDown":t=this.calendarElement.querySelector("button.next"),t&&await this.fetchCalendar(this.getDate(t),this.viewMode);break;case"Enter":t=this.calendarElement.querySelector(".ranges .selected"),t&&(this.viewMode==="h"||this.viewMode==="w"&&this.dateOnly?this.selectDate(t):this.fetchCalendar(this.getDate(t),a.get(this.viewMode)));break;default:return}e.preventDefault()};this.turnPrev=()=>{this.fetchCalendar(this.prevSheetDate,this.viewMode)};this.turnNext=()=>{this.fetchCalendar(this.nextSheetDate,this.viewMode)};this.turnNarrow=()=>{this.narrowSheetDate&&(this.viewMode==="m"?this.fetchCalendar(this.narrowSheetDate,"w"):this.viewMode==="y"?this.fetchCalendar(this.narrowSheetDate,"m"):this.fetchCalendar(this.narrowSheetDate,this.viewMode))};this.turnExtend=()=>{this.extendSheetDate&&(this.viewMode==="h"?this.fetchCalendar(this.extendSheetDate,"w"):this.viewMode==="w"?this.fetchCalendar(this.extendSheetDate,"m"):this.fetchCalendar(this.extendSheetDate,"y"))};this.turnToday=()=>{this.dateOnly?this.selectToday():this.fetchCalendar(this.todayDate,"h")};this.selectDay=e=>{e.target instanceof HTMLLIElement&&(this.dateOnly?this.selectDate(e.target):this.fetchCalendar(this.getDate(e.target),"h"))};this.selectMonth=e=>{e.target instanceof HTMLLIElement&&this.fetchCalendar(this.getDate(e.target),"w")};this.selectYear=e=>{e.target instanceof HTMLLIElement&&this.fetchCalendar(this.getDate(e.target),"m")};this.inputElement=e,this.dateOnly=e.getAttribute("is")==="django-datepicker",this.localTime=e.hasAttribute("local-time"),this.setDateTimeFormat(),this.setInitialDate(),t instanceof HTMLElement?this.calendarElement=t:(this.calendarElement=document.createElement("div"),this.fetchCalendar(new Date,"w")),this.setBounds(),this.installEventHandlers(),new MutationObserver(()=>this.registerElement()).observe(this.calendarElement,{childList:!0}),this.transferStyles(),this.registerElement()}getViewMode(){var t;switch((t=this.calendarElement.querySelector(":scope > [aria-label]"))==null?void 0:t.getAttribute("aria-label")){case"hours-view":return"h";case"weeks-view":return"w";case"months-view":return"m";case"years-view":return"y";default:throw new Error(`Unknown aria-label on ${this.calendarElement}`)}}setInitialDate(){this.inputElement.value&&(this.initialDate=this.convertDate(new Date(this.inputElement.value)),this.inputElement.value=this.asString(this.initialDate))}convertDate(e,t=!1){return(this.localTime||t)&&e.setTime(e.getTime()-6e4*e.getTimezoneOffset()),e}setBounds(){let e=this.inputElement.getAttribute("min");e&&(this.minDate=this.convertDate(new Date(e)),this.minWeekDate=new Date(this.minDate),this.minWeekDate.setHours(0,0,0),this.minMonthDate=new Date(this.minWeekDate),this.minMonthDate.setDate(1),this.minYearDate=new Date(this.minMonthDate),this.minYearDate.setMonth(0));let t=this.inputElement.getAttribute("max");t&&(this.maxDate=this.convertDate(new Date(t)),this.maxWeekDate=new Date(this.maxDate),this.maxWeekDate.setHours(23,59,59),this.maxMonthDate=new Date(this.maxWeekDate),this.maxMonthDate.setDate(28),this.maxYearDate=new Date(this.maxMonthDate),this.maxYearDate.setMonth(11));let a=this.inputElement.getAttribute("step");if(a){let n=new Date("1970-01-01 0:00:00"),s=new Date(`1970-01-01 ${a}`);this.interval=(s.getTime()-n.getTime())/6e4}}setDateTimeFormat(){let e=Array(),t=Array(),a=Array();if(this.inputElement.getAttribute("date-format")==="iso"){this.autoZeroRegExps.length=this.autoDelimiterRegExps.length=0,this.autoZeroRegExps.push(new RegExp("^(\\d{4}-)(\\d{1}-)$")),this.autoZeroRegExps.push(new RegExp("^(\\d{4}-\\d{2}-)(\\d{1}\\s)$")),this.autoDelimiterRegExps.push(new RegExp("^\\d{4}$")),this.autoDelimiterRegExps.push(new RegExp("^\\d{4}-\\d{2}$")),this.dateOnly||(this.autoZeroRegExps.push(new RegExp("^(\\d{4}-\\d{2}-\\d{2}\\s)(\\d{1}:)$")),this.autoSpaceRegExp=new RegExp("^\\d{4}-\\d{2}-\\d{2}$"),this.autoColonRegExp=new RegExp("^\\d{4}-\\d{2}-\\d{2}\\s\\d{2}$")),this.dateOnly?this.setExtraAttributes("yyyy-mm-dd","\\d{4}-\\d{2}-\\d{2}"):this.setExtraAttributes("yyyy-mm-dd HH:MM","\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}");return}this.dateTimeFormat=Intl.DateTimeFormat(navigator.language,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,calendar:"iso8601"}),this.dateTimeFormat.formatToParts().forEach(n=>{switch(n.type){case"day":e.push("dd"),t.push("\\d{2}"),a.push("(?<day>\\d{1,2})");break;case"month":e.push("mm"),t.push("\\d{2}"),a.push("(?<month>\\d{1,2})");break;case"year":e.push("yyyy"),t.push("\\d{4}"),a.push("(?<year>\\d{4})");break;case"literal":[".","/","-"].includes(n.value)&&(this.delimiter=n.value,e.push(n.value),t.push(n.value),a.push(n.value)),this.dateOnly||([", "," "].includes(n.value)&&(e.push(" "),t.push("\\s"),a.push("\\s")),[":"].includes(n.value)&&(e.push(n.value),t.push(n.value),a.push(n.value)));break;case"hour":this.dateOnly||(e.push("HH"),t.push("\\d{2}"),a.push("(?<hour>\\d{1,2})"));break;case"minute":this.dateOnly||(e.push("MM"),t.push("\\d{2}"),a.push("(?<minute>\\d{1,2})"));break;default:break}}),this.dateTimeRegExp=new RegExp(a.join("")),this.autoZeroRegExps.length=this.autoDelimiterRegExps.length=0,this.autoDelimiterRegExps.push(new RegExp("^\\d{2}$")),this.delimiter==="."?(this.autoZeroRegExps.push(new RegExp("^(\\D*)(\\d{1}\\.)$")),this.autoZeroRegExps.push(new RegExp("^(\\d{2}\\.)(\\d{1}\\.)$")),this.autoDelimiterRegExps.push(new RegExp("^\\d{2}\\.\\d{2}$")),this.dateOnly||(this.autoZeroRegExps.push(new RegExp("^(\\d{2}\\.\\d{2}\\.\\d{4}\\s)(\\d{1}:)$")),this.autoSpaceRegExp=new RegExp("^(\\d{2}\\.\\d{2}\\.\\d{4})$"),this.autoColonRegExp=new RegExp("^\\d{2}\\.\\d{2}\\.\\d{4}\\s\\d{2}$"))):(this.autoZeroRegExps.push(new RegExp("^(\\D*)(\\d{1}/)$")),this.autoZeroRegExps.push(new RegExp("^(\\d{2}/)(\\d{1}/)$")),this.autoDelimiterRegExps.push(new RegExp("^\\d{2}/\\d{2}$")),this.dateOnly||(this.autoZeroRegExps.push(new RegExp("^(\\d{2}/\\d{2}/\\d{4}\\s)(\\d{1}:)$")),this.autoSpaceRegExp=new RegExp("^(\\d{2}/\\d{2}/\\d{4})$"),this.autoColonRegExp=new RegExp("^\\d{2}/\\d{2}/\\d{4}\\s\\d{2}$"))),this.setExtraAttributes(e.join(""),t.join(""))}setExtraAttributes(e,t){this.inputElement.hasAttribute("placeholder")||this.inputElement.setAttribute("placeholder",e),this.inputElement.hasAttribute("pattern")||this.inputElement.setAttribute("pattern",t)}installEventHandlers(){this.inputElement.addEventListener("focus",this.handleFocus),this.inputElement.addEventListener("blur",this.handleBlur),this.inputElement.addEventListener("input",this.handleInput),this.inputElement.addEventListener("change",this.handleChange),document.addEventListener("click",this.handleClick),document.addEventListener("keydown",this.handleKeypress)}close(){this.isOpen=!1,this.inputElement.setAttribute("aria-expanded","false"),this.cleanup&&this.cleanup()}asDate(){if(this.inputElement.value)if(this.dateTimeRegExp){let e=this.inputElement.value.match(this.dateTimeRegExp);if(e&&e.groups)return this.dateOnly?new Date(parseInt(e.groups.year),parseInt(e.groups.month)-1,parseInt(e.groups.day)):new Date(parseInt(e.groups.year),parseInt(e.groups.month)-1,parseInt(e.groups.day),parseInt(e.groups.hour),parseInt(e.groups.minute))}else{let e=new Date(this.inputElement.value);if(!isNaN(e.getTime()))return e}}asUTCDate(e){return new Date(e.getTime()-e.getTimezoneOffset()*6e4)}asString(e){return(this.dateTimeFormat?this.dateTimeFormat.format(e).replace(", "," "):this.asUTCDate(e).toISOString().replace("T"," ")).slice(0,this.dateOnly?10:16)}getDate(e){let t=e instanceof Element?e:this.calendarElement.querySelector(e);if(!(t instanceof Element))throw new Error(`Element ${e} is missing`);let a=t.getAttribute("data-date")??t.getAttribute("datetime");return new Date(a??"")}registerElement(){var n,s,o,l,c;this.viewMode=this.getViewMode(),this.prevSheetDate=this.getDate("button.prev");let e=this.calendarElement.querySelector("button.narrow");this.narrowSheetDate=e?this.getDate(e):void 0,this.todayDate=this.convertDate(new Date(Date.now()),!0),this.nextSheetDate=this.getDate("button.next");let t=this.calendarElement.querySelector("button.extend");switch(this.extendSheetDate=t?this.getDate(t):void 0,(n=this.calendarElement.querySelector("button.prev"))==null||n.addEventListener("click",this.turnPrev,{once:!0}),(s=this.calendarElement.querySelector("button.narrow"))==null||s.addEventListener("click",this.turnNarrow,{once:!0}),(o=this.calendarElement.querySelector("button.extend"))==null||o.addEventListener("click",this.turnExtend,{once:!0}),(l=this.calendarElement.querySelector("button.today"))==null||l.addEventListener("click",this.turnToday,{once:!0}),(c=this.calendarElement.querySelector("button.next"))==null||c.addEventListener("click",this.turnNext,{once:!0}),this.calendarItems=this.calendarElement.querySelectorAll("li[data-date]"),this.viewMode){case"h":this.registerHoursView();break;case"w":this.registerWeeksView();break;case"m":this.registerMonthsView();break;case"y":this.registerYearsView();break}let a=this.calendarElement.querySelector("button.today > svg > text");a instanceof SVGTextElement&&(a.textContent=String(new Date().getDate()))}registerHoursView(){let e=this.todayDate.toISOString().slice(0,13).concat(":00"),t=this.asDate(),a=t?this.asUTCDate(t).toISOString():"";if(this.interval){let s=`repeat(${Math.min(60/this.interval,6)}, 1fr)`;this.calendarElement.querySelectorAll(".ranges ul.minutes").forEach(o=>{o.style.gridTemplateColumns=s})}this.calendarItems.forEach(n=>{n.classList.toggle("selected",n.getAttribute("data-date")===a.slice(0,16));let s=this.getDate(n);this.minDate&&s<this.minDate||this.maxDate&&s>this.maxDate?n.toggleAttribute("disabled",!0):n.addEventListener("click",o=>{o.target instanceof HTMLLIElement&&this.selectDate(o.target)},{once:!0})}),this.calendarElement.querySelectorAll("li[aria-label]").forEach(n=>{var l;let s=n.getAttribute("aria-label");n.classList.toggle("today",s===e);let o=`ul[aria-labelledby="${s}"]`;s.slice(0,13)===a.slice(0,13)&&(n.classList.add("preselected"),(l=this.calendarElement.querySelector(o))==null||l.removeAttribute("hidden")),this.calendarElement.querySelectorAll(`${o} > li[data-date]:not([disabled])`).length===0?n.toggleAttribute("disabled",!0):n.addEventListener("click",c=>{c.target instanceof HTMLLIElement&&this.selectHour(c.target)})})}registerWeeksView(){let e=this.todayDate.toISOString().slice(0,10),t=this.asDate(),a=t?this.asUTCDate(t).toISOString().slice(0,10):null;this.calendarItems.forEach(n=>{n.classList.toggle("today",n.getAttribute("data-date")===e),n.classList.toggle("selected",n.getAttribute("data-date")===a);let s=this.getDate(n);this.minWeekDate&&s<this.minWeekDate||this.maxWeekDate&&s>this.maxWeekDate?n.toggleAttribute("disabled",!0):n.addEventListener("click",this.selectDay)})}registerMonthsView(){let e=this.todayDate.toISOString().slice(0,7),t=this.asDate(),a=t?this.asUTCDate(t).toISOString().slice(0,7):null;this.calendarItems.forEach(n=>{var l;let s=this.getDate(n),o=(l=n.getAttribute("data-date"))==null?void 0:l.slice(0,7);n.classList.toggle("today",o===e),n.classList.toggle("selected",o===a),this.minMonthDate&&s<this.minMonthDate||this.maxMonthDate&&s>this.maxMonthDate?n.toggleAttribute("disabled",!0):n.addEventListener("click",this.selectMonth)})}registerYearsView(){let e=this.todayDate.toISOString().slice(0,4),t=this.asDate(),a=t?this.asUTCDate(t).toISOString().slice(0,4):null;this.calendarItems.forEach(n=>{var l;let s=this.getDate(n),o=(l=n.getAttribute("data-date"))==null?void 0:l.slice(0,4);n.classList.toggle("today",o===e),n.classList.toggle("selected",o===a),this.minYearDate&&s<this.minYearDate||this.maxYearDate&&s>this.maxYearDate?n.toggleAttribute("disabled",!0):n.addEventListener("click",this.selectYear)})}getDelta(e,t){let a=(this.interval??60)<60?new Map([[0,-60],[1,+this.interval],[2,60],[3,-this.interval]]):new Map([[0,-360],[1,60],[2,360],[3,-60]]),n=new Map([[0,-10080],[1,1440],[2,10080],[3,-1440]]),s=this.convertDate(t,!0);switch(this.viewMode){case"h":return new Date(s.getTime()+6e4*a.get(e));case"w":return new Date(s.getTime()+6e4*n.get(e));case"m":switch(e){case 0:s.setMonth(s.getMonth()-3);break;case 1:s.setMonth(s.getMonth()+1);break;case 2:s.setMonth(s.getMonth()+3);break;case 3:s.setMonth(s.getMonth()-1);break}break;case"y":switch(e){case 0:s.setFullYear(t.getFullYear()-4);break;case 1:s.setFullYear(t.getFullYear()+1);break;case 2:s.setFullYear(t.getFullYear()+4);break;case 3:s.setFullYear(t.getFullYear()-1);break}break}return s}async navigate(e){let t=this.calendarElement.querySelector("li[data-date].selected");if(t||(t=this.calendarItems.item(this.calendarItems.length/2)),t){let a=this.getDate(t),n=this.getDelta(e,a),s=l=>l.toISOString().slice(0,this.viewMode==="h"?16:10),o=null;(this.viewMode!=="w"||a.getMonth()===n.getMonth())&&(o=this.calendarElement.querySelector(`.ranges li[data-date="${s(n)}"]`)),o||(await this.fetchCalendar(n,this.viewMode),o=this.calendarElement.querySelector(`.ranges li[data-date="${s(n)}"]`)),o instanceof HTMLLIElement&&(this.viewMode==="h"&&this.selectHour(o),this.setDate(o))}}validate(){let e=this.getValidDate();if(e)return e;this.inputElement.value.length>0&&(this.inputElement.value=this.inputElement.value.concat(" "))}getValidDate(){let e=this.asDate();if(e&&this.asString(e)===this.inputElement.value)return e}async selectToday(){let e=this.todayDate.toISOString().slice(0,10),t=this.calendarElement.querySelector(`li[data-date="${e}"]`);t||(await this.fetchCalendar(this.todayDate,"w"),t=this.calendarElement.querySelector(`li[data-date="${e}"]`)),this.selectDate(t)}setDate(e){this.calendarItems.forEach(a=>{a.classList.toggle("selected",a.isSameNode(e))});let t=e.getAttribute("data-date");this.dateTimeFormat&&(t=this.asString(new Date(t))),this.dateOnly?this.inputElement.value=t.slice(0,10):t.length===10?this.inputElement.value=t.concat(" 12:00"):this.inputElement.value=t.replace("T"," ")}selectDate(e){this.setDate(e),this.close(),this.inputElement.blur(),this.inputElement.dispatchEvent(new Event("input"))}selectHour(e){var n;let t=s=>{s.querySelectorAll("li[data-date]").forEach(o=>{o.addEventListener("click",l=>{l.target instanceof HTMLLIElement&&(l.target.classList.add("selected"),this.selectDate(l.target))},{once:!0})})};this.calendarElement.querySelectorAll("li[aria-label]").forEach(s=>{s.classList.remove("selected","preselected")}),this.calendarElement.querySelectorAll("ul[aria-labelledby]").forEach(s=>{s.toggleAttribute("hidden",!0)});let a=e.getAttribute("aria-label");if(a){let s=this.calendarElement.querySelector(`ul[aria-labelledby="${a}"]`);s instanceof HTMLUListElement&&(e.classList.add("preselected"),s.removeAttribute("hidden"),t(s))}else if(e.parentElement instanceof HTMLUListElement&&e.parentElement.hasAttribute("aria-labelledby")){let s=e.parentElement.getAttribute("aria-labelledby");(n=this.calendarElement.querySelector(`li[aria-label="${s}"]`))==null||n.classList.add("preselected"),e.parentElement.removeAttribute("hidden"),t(e.parentElement)}}controlButton(e){let t=e;for(;!(t instanceof HTMLButtonElement);){if(!(t instanceof Element))throw new Error(`Element ${e} not part of button`);t=t.parentElement}return t}async fetchCalendar(e,t){let a=new URLSearchParams("calendar");a.set("date",e.toISOString().slice(0,10)),a.set("mode",t),this.interval&&a.set("interval",String(this.interval));let n=await fetch(`${this.endpoint}?${a.toString()}`,{method:"GET"});if(n.status===200){let s=await n.text();this.calendarElement.innerHTML=s}else console.error(`Failed to fetch from ${this.endpoint} (status=${n.status})`)}transferStyles(){var a,n,s;for(let o=0;o<document.styleSheets.length;++o){let l=(s=(n=(a=document==null?void 0:document.styleSheets)==null?void 0:a.item(o))==null?void 0:n.cssRules)==null?void 0:s.item(0);if(l instanceof CSSStyleRule&&l.selectorText.startsWith(':is([is="django-datepicker"], [is="django-datetimepicker"])'))return}let e=document.createElement("style");e.innerText=Ve,document.head.appendChild(e);let t=window.getComputedStyle(this.inputElement).getPropertyValue("height");for(let o=0;e.sheet&&o<e.sheet.cssRules.length;o++){let l=e.sheet.cssRules.item(o),c;switch(l.selectorText){case':is([is="django-datepicker"], [is="django-datetimepicker"]) + .dj-calendar':c=H.extractStyles(this.inputElement,["background-color","border","border-radius","font-family","font-size","font-strech","font-style","font-weight","letter-spacing","white-space","line-height"]),e.sheet.insertRule(`${l.selectorText}{${c}}`,++o);break;case':is([is="django-datepicker"], [is="django-datetimepicker"]) + .dj-calendar .controls':c=H.extractStyles(this.inputElement,["padding"]),e.sheet.insertRule(`${l.selectorText}{${c}}`,++o);break;case':is([is="django-datepicker"], [is="django-datetimepicker"]) + .dj-calendar .ranges':c=H.extractStyles(this.inputElement,["padding"]),e.sheet.insertRule(`${l.selectorText}{${c}}`,++o);break;case':is([is="django-datepicker"], [is="django-datetimepicker"]) + .dj-calendar .ranges ul:not(.weekdays)':c=`line-height: ${t};`,e.sheet.insertRule(`${l.selectorText}{${c}}`,++o);break;case':is([is="django-datepicker"], [is="django-datetimepicker"]) + .dj-calendar .ranges ul.hours > li.preselected':case':is([is="django-datepicker"], [is="django-datetimepicker"]) + .dj-calendar .ranges ul.minutes':this.inputElement.style.transition="none",this.inputElement.classList.add("-focus-"),c=H.extractStyles(this.inputElement,["border-color"]),e.sheet.insertRule(`${l.selectorText}{${c}}`,++o),this.inputElement.classList.remove("-focus-"),this.inputElement.style.transition="",l.selectorText===':is([is="django-datepicker"], [is="django-datetimepicker"]) + .dj-calendar .ranges ul.hours > li.preselected'&&(c=H.extractStyles(this.calendarElement,["background-color"]),c=c.replace("background-color","border-bottom-color"),e.sheet.insertRule(`${l.selectorText}{${c}}`,++o));break;default:break}}}formResetted(e){}formSubmitted(e){}valueAsDate(){let e=this.asDate();return e?(this.localTime||e.setTime(e.getTime()-6e4*e.getTimezoneOffset()),e):null}},F=Symbol("DateTimePickerElement"),Oe=class extends HTMLInputElement{connectedCallback(){let e=this.closest("django-field-group");if(!e)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let t=e.querySelector('[aria-label="calendar"]');this[F]=new _(this,t)}get valueAsDate(){return this[F].valueAsDate()}};F;var He=class extends HTMLInputElement{connectedCallback(){let e=this.closest("django-field-group");if(!e)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let t=e.querySelector('[aria-label="calendar"]');this[F]=new _(this,t)}get valueAsDate(){return this[F].valueAsDate()}};F;export{Oe as DatePickerElement,He as DateTimePickerElement};
