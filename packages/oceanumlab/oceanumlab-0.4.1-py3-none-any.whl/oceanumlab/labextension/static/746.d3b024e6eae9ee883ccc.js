"use strict";(self.webpackChunk_oceanum_oceanumlab=self.webpackChunk_oceanum_oceanumlab||[]).push([[746,549],{746:(e,t,n)=>{n.r(t),n.d(t,{datamesh_connect_extension:()=>j,default:()=>S});var a=n(866),o=n(510),r=n(886),s=n(591),i=n(918),c=n(258),l=n(598),d=n(397),p=n(952),u=n(767),m=n(526),h=n(694),g=n(840),f=n(271),v=n.n(f),k=n(261);n(549);const y=({datasource:e,insertDatasource:t,onMouseDown:n})=>{const[a,o]=(0,f.useState)(!1),r=()=>{o(!a)};return v().createElement("div",{className:a&&"expanded"},v().createElement("div",{key:e.id,className:"datasource-item-title"},v().createElement("button",{title:a?"Hide Details":"Show Details",onClick:r,className:"datasource-item-expand"},a?v().createElement(s.caretDownIcon.react,{tag:"span",elementPosition:"center",width:"20px"}):v().createElement(s.caretRightIcon.react,{tag:"span",elementPosition:"center",width:"20px"})),v().createElement("span",{title:e.description,className:n?"datasource-item-name":"datasource-item-name draggable",onClick:r,onMouseDown:t=>n(t,e)},e.description),v().createElement("button",{title:"Insert code to load datasource",onClick:r,className:"datasource-item-action"},v().createElement(k.ArrowBendDownRight,{size:18,onClick:n=>t(e)}))),a&&v().createElement("div",{className:"datasource-item-details"},v().createElement("div",{className:"datasource-query-field"},"Datasource id: ",v().createElement("span",null,e.datasource)),e.geofilter&&v().createElement("div",{className:"datasource-query-field"},"Geofilter type:",v().createElement("span",null,e.geofilter.type)),e.variables&&v().createElement("div",{className:"datasource-query-field"},"Variables:",v().createElement("span",null,e.variables.join(","))),e.timefilter&&v().createElement("div",{className:"datasource-query-field"},"Timefilter:",v().createElement("span",null,e.timefilter.times[0]),v().createElement("span",null,"to"),v().createElement("span",null,e.timefilter.times[1])),e.spatialref&&v().createElement("div",{className:"datasource-query-field"},"Spatial ref:",v().createElement("span",null,e.spatialref)),v().createElement("div",null,v().createElement("a",{href:`https://oceanum.io/datasets/${e.datasource}`,target:"_blank"},"Datasource details"))))},b=e=>{if(!e||!e.widgets.find((e=>{const t=e.editor.getLine(0);if(t&&t.indexOf("DATAMESH_TOKEN=")>=0)return!0})))return`DATAMESH_TOKEN='${window.datameshToken}';`},w=(e,t,n)=>{const a=t&&t.widgets.find((e=>{let t=!1;for(let a=0;a<n;a++){const n=e.editor.getLine(a);if(n&&n.indexOf("from oceanum.datamesh import Connector")>=0){t=!0;break}}return t}));let o=e.datasource.replace(/[\s-.]/g,"_");const r=window.injectToken?"token=DATAMESH_TOKEN":"";return e.variables||e.geofilter||e.timefilter||e.spatialref?o+=`=datamesh.query(${JSON.stringify(e,null,"  ").replace(/null/g,"None")})`:o+=`=datamesh.load_datasource('${e.datasource}')`,a||(o=`from oceanum.datamesh import Connector\n#Put your datamesh token in the Jupyterlab settings, or as argument in the constructor below\ndatamesh=Connector(${r})\n`+o),o};class x extends v().Component{constructor(e){super(e),this.injectToken=e=>{const t=e.content,n=b(t);if(n){const a=t.model.contentFactory.createCodeCell({cell:{cell_type:"code",source:n,metadata:{tags:["hide_input"]}}});t.model.cells.insert(0,a),p.CodeCell.execute(t.widgets[0],e.sessionContext)}},this.insertDatameshConnect=async e=>{const t=this.props.getCurrentWidget();if(t instanceof u.NotebookPanel){const n=t,a=n.content,o=a.activeCell,r=a.activeCellIndex,s=o.editor,i=w(e,a,r);o instanceof p.CodeCell?this.verifyLanguageAndInsert(i,"python",s):s.replaceSelection(i),window.injectToken&&this.injectToken(n)}else this.showErrDialog("Datamesh datasource insert failed: Please select code cell")},this.verifyLanguageAndInsert=async(e,t,n)=>{t&&"python"!==t.toLowerCase()?(await this.showWarnDialog(t)).button.accept&&n.replaceSelection(e):n.replaceSelection(e)},this.showWarnDialog=async e=>(0,o.showDialog)({title:"Warning",body:`Datamesh connector is incompatible with ${e}. Continue?`,buttons:[o.Dialog.cancelButton(),o.Dialog.okButton()]}),this.showErrDialog=e=>(0,o.showDialog)({title:"Error",body:e,buttons:[o.Dialog.okButton()]}),this._drag=null,this._dragData=null,this.handleDragMove=this.handleDragMove.bind(this),this._evtMouseUp=this._evtMouseUp.bind(this)}render(){return v().createElement("div",{className:"datamesh-workspace-display"},this.props.spec&&v().createElement("div",null,v().createElement("span",{className:"datamesh-workspace-name"},this.props.spec.name),v().createElement("hr",null),this.props.spec.data.map((e=>v().createElement("div",{key:e.id,"data-item-id":e.id,className:"datasource-item"},v().createElement(y,{datasource:e,insertDatasource:this.insertDatameshConnect,onMouseDown:t=>{this.handleDragSnippet(t,e)}}))))))}handleDragSnippet(e,t){const{button:n}=e;if(0!==n)return;this._dragData={pressX:e.clientX,pressY:e.clientY,dragImage:null};const a=e=>{this._evtMouseUp(e,t,o)},o=e=>{this.handleDragMove(e,t,o,a)},r=e.target;r.addEventListener("mouseup",a,{once:!0,capture:!0}),r.addEventListener("mousemove",o,!0),r.ondragstart=()=>!1}_evtMouseUp(e,t,n){e.preventDefault(),e.stopPropagation(),e.target.removeEventListener("mousemove",n,!0)}handleDragMove(e,t,n,a){e.preventDefault(),e.stopPropagation();const o=this._dragData;if(o&&this.shouldStartDrag(o.pressX,o.pressY,e.clientX,e.clientY)){const r=document.createElement("div");r.innerHTML=t.description,r.classList.add("datasource-drag-image"),o.dragImage=r;const s=e.target;s.removeEventListener("mousemove",n,!0),s.removeEventListener("mouseup",a,!0),this.startDrag(o.dragImage,t,e.clientX,e.clientY)}}shouldStartDrag(e,t,n,a){const o=Math.abs(n-e),r=Math.abs(a-t);return o>=0||r>=5}async startDrag(e,t,n,a){const o=new u.NotebookModel.ContentFactory({}).createCodeCell({});let r=w(t,null,0);if(window.injectToken){const e=this.props.getCurrentWidget();r=b(e.content)+"\n"+r}o.value.text=r,this._drag=new h.Drag({mimeData:new m.MimeData,dragImage:e,supportedActions:"copy-move",proposedAction:"copy",source:this});const s=[o.toJSON()];return this._drag.mimeData.setData("application/vnd.jupyter.cells",s),this._drag.mimeData.setData("text/plain",t.description),this._drag.start(n,a).then((()=>{this._drag=null,this._dragData=null}))}}class D extends o.ReactWidget{constructor(e){super(),this.datameshWorkspaceSpec=null,this.props=e,this.renderSignal=new g.Signal(this),this.renderDisplay=this.renderDisplay.bind(this),window.addEventListener("message",this.receiveIFrameMessage.bind(this),!1)}receiveIFrameMessage(e){e.data&&"workspace-modify"===e.data.action&&(this.datameshWorkspaceSpec={id:e.data.id,name:e.data.name,data:e.data.data},this.renderSignal.emit(this.datameshWorkspaceSpec))}renderDisplay(e){return v().createElement(v().Fragment,null,this.datameshWorkspaceSpec?v().createElement(x,{spec:e,openDatameshUI:this.props.openDatameshUI,getCurrentWidget:this.props.getCurrentWidget,shell:this.props.app.shell}):v().createElement("div",{className:"datasource-item-details"},v().createElement("a",{onClick:this.props.openDatameshUI},"Open")," the Oceanum datamesh UI to add datasources. You will need to allow popups on this page if you are not already logged in to Oceanum.io."))}render(){return v().createElement("div",{className:"datamesh-connect"},v().createElement("header",{className:"datamesh-connect-header"},v().createElement(this.props.icon.react,{tag:"span",width:"auto",height:"24px",verticalAlign:"middle",marginRight:"5px"}),v().createElement("p",null," Datamesh workspace "),v().createElement("div",{className:"open-datamesh-ui",onClick:this.props.openDatameshUI,title:"Open Datamesh UI"},v().createElement(s.addIcon.react,{height:"24px",verticalAlign:"middle"}))),v().createElement(o.UseSignal,{signal:this.renderSignal,initialArgs:null},((e,t)=>this.renderDisplay(t))))}}class E extends o.ReactWidget{render(){return v().createElement("iframe",{src:"https://ui.datamesh.oceanum.io",className:"datamesh-iframe"})}}const C=new s.LabIcon({name:"oceanum:main",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44.079582 44.079582" version="1.1" id="svg5870">\n  <g\n     id="layer1"\n     transform="translate(-82.281595,-124.52568)">\n    <g\n       style="stroke:#3b547c;stroke-opacity:1"\n       transform="matrix(0.26458333,0,0,0.26458333,69.475762,109.81485)"\n       id="g2915"\n       >\n      <g\n         style="stroke:#3b547c;stroke-opacity:1"\n         id="g2903">\n        <path\n           id="path2897"\n           d="m 212.3,149.9 c -35.8,19.1 -58.2,-11 -80.6,-11 -22.4,0 -44.7,30.1 -80.6,11 1.2,8.7 3.8,17.2 7.7,25.1 38.7,13.5 55.8,-8.4 72.9,-8.4 17.1,0 34.1,22 72.9,8.4 3.9,-7.9 6.5,-16.3 7.7,-25.1 z"\n           class="st8"\n           \n           style="fill:#dce1f9;stroke:#3b547c;stroke-opacity:1" />\n        <path\n           id="path2899"\n           d="m 204.6,175 c -38.7,13.5 -55.8,-8.4 -72.9,-8.4 -17.1,0 -34.1,22 -72.9,8.4 4.4,8.9 10.4,16.9 17.7,23.6 31.1,6.8 43.1,-6.5 55.2,-6.5 12.1,0 24.1,13.3 55.2,6.5 7.3,-6.7 13.3,-14.7 17.7,-23.6 z"\n           class="st8"\n           \n           style="fill:#dce1f9;stroke:#3b547c;stroke-opacity:1" />\n        <path\n           id="path2901"\n           d="m 76.5,198.7 c 31.1,6.8 43.1,-6.5 55.2,-6.5 12.1,0 24.1,13.3 55.2,6.5 -15,13.9 -34.7,21.6 -55.2,21.6 -20.4,-0.1 -40.2,-7.8 -55.2,-21.6 z"\n           class="st8"\n           \n           style="fill:#dce1f9;stroke:#3b547c;stroke-opacity:1" />\n      </g>\n      <g\n         style="stroke:#3b547c;stroke-opacity:1"\n         id="g2913">\n        <path\n           id="path2905"\n           d="m 58.8,175 c 38.7,13.5 55.8,-8.4 72.9,-8.4 17.1,0 34.1,22 72.9,8.4"\n           class="st9"\n           \n           style="fill:none;stroke:#3b547c;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1" />\n        <path\n           id="path2907"\n           d="m 51.1,149.9 c 35.8,19.1 58.2,-11 80.6,-11 22.4,0 44.7,30.1 80.6,11"\n           class="st9"\n           \n           style="fill:none;stroke:#3b547c;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1" />\n        <path\n           id="path2909"\n           d="m 76.5,198.7 c 31.1,6.8 43.1,-6.5 55.2,-6.5 12.1,0 24.1,13.3 55.2,6.5"\n           class="st9"\n           \n           style="fill:none;stroke:#3b547c;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1" />\n        <path\n           id="path2911"\n           d="m 131.7,220.2 c 10.3,0 20.4,-1.9 29.9,-5.7 10.3,-4.1 19.7,-10.2 27.6,-18.1 7.9,-7.9 14,-17.2 18.1,-27.6 3.8,-9.5 5.7,-19.7 5.7,-29.9 0,-10.3 -1.9,-20.4 -5.7,-29.9 -4.1,-10.3 -10.2,-19.7 -18.1,-27.6 -7.9,-7.9 -17.2,-14 -27.6,-18.1 -9.5,-3.8 -19.7,-5.7 -29.9,-5.7 -10.3,0 -20.4,1.9 -29.9,5.7 -10.3,4.1 -19.7,10.2 -27.6,18.1 -7.9,7.9 -14,17.2 -18.1,27.6 -3.8,9.5 -5.7,19.7 -5.7,29.9 0,10.3 1.9,20.4 5.7,29.9 4.1,10.3 10.2,19.7 18.1,27.6 7.9,7.9 17.2,14 27.6,18.1 9.5,3.8 19.6,5.7 29.9,5.7 z"\n           class="st9"\n           \n           style="fill:none;stroke:#3b547c;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1" />\n      </g>\n    </g>\n    <g\n       id="g3308"\n       transform="matrix(0.26458333,0,0,0.26458333,69.475762,109.81485)"\n       style="stroke:#3b547c;stroke-opacity:1">\n      <g\n         id="g3296"\n         style="stroke:#3b547c;stroke-opacity:1">\n        <path\n           style="fill:#dce1f9;stroke:#3b547c;stroke-opacity:1"\n           \n           class="st8"\n           d="m 212.3,149.9 c -35.8,19.1 -58.2,-11 -80.6,-11 -22.4,0 -44.7,30.1 -80.6,11 1.2,8.7 3.8,17.2 7.7,25.1 38.7,13.5 55.8,-8.4 72.9,-8.4 17.1,0 34.1,22 72.9,8.4 3.9,-7.9 6.5,-16.3 7.7,-25.1 z"\n           id="path3290" />\n        <path\n           style="fill:#dce1f9;stroke:#3b547c;stroke-opacity:1"\n           \n           class="st8"\n           d="m 204.6,175 c -38.7,13.5 -55.8,-8.4 -72.9,-8.4 -17.1,0 -34.1,22 -72.9,8.4 4.4,8.9 10.4,16.9 17.7,23.6 31.1,6.8 43.1,-6.5 55.2,-6.5 12.1,0 24.1,13.3 55.2,6.5 7.3,-6.7 13.3,-14.7 17.7,-23.6 z"\n           id="path3292" />\n        <path\n           style="fill:#dce1f9;stroke:#3b547c;stroke-opacity:1"\n           \n           class="st8"\n           d="m 76.5,198.7 c 31.1,6.8 43.1,-6.5 55.2,-6.5 12.1,0 24.1,13.3 55.2,6.5 -15,13.9 -34.7,21.6 -55.2,21.6 -20.4,-0.1 -40.2,-7.8 -55.2,-21.6 z"\n           id="path3294" />\n      </g>\n      <g\n         id="g3306"\n         style="stroke:#3b547c;stroke-opacity:1">\n        <path\n           style="fill:none;stroke:#3b547c;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1"\n           \n           class="st9"\n           d="m 58.8,175 c 38.7,13.5 55.8,-8.4 72.9,-8.4 17.1,0 34.1,22 72.9,8.4"\n           id="path3298" />\n        <path\n           style="fill:none;stroke:#3b547c;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1"\n           \n           class="st9"\n           d="m 51.1,149.9 c 35.8,19.1 58.2,-11 80.6,-11 22.4,0 44.7,30.1 80.6,11"\n           id="path3300" />\n        <path\n           style="fill:none;stroke:#3b547c;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1"\n           \n           class="st9"\n           d="m 76.5,198.7 c 31.1,6.8 43.1,-6.5 55.2,-6.5 12.1,0 24.1,13.3 55.2,6.5"\n           id="path3302" />\n        <path\n           style="fill:none;stroke:#3b547c;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1"\n           \n           class="st9"\n           d="m 131.7,220.2 c 10.3,0 20.4,-1.9 29.9,-5.7 10.3,-4.1 19.7,-10.2 27.6,-18.1 7.9,-7.9 14,-17.2 18.1,-27.6 3.8,-9.5 5.7,-19.7 5.7,-29.9 0,-10.3 -1.9,-20.4 -5.7,-29.9 -4.1,-10.3 -10.2,-19.7 -18.1,-27.6 -7.9,-7.9 -17.2,-14 -27.6,-18.1 -9.5,-3.8 -19.7,-5.7 -29.9,-5.7 -10.3,0 -20.4,1.9 -29.9,5.7 -10.3,4.1 -19.7,10.2 -27.6,18.1 -7.9,7.9 -14,17.2 -18.1,27.6 -3.8,9.5 -5.7,19.7 -5.7,29.9 0,10.3 1.9,20.4 5.7,29.9 4.1,10.3 10.2,19.7 18.1,27.6 7.9,7.9 17.2,14 27.6,18.1 9.5,3.8 19.6,5.7 29.9,5.7 z"\n           id="path3304" />\n      </g>\n    </g>\n  </g>\n</svg>\n'}),j={id:"datamesh-connect",autoStart:!0,requires:[o.ICommandPalette,a.ILayoutRestorer,a.ILabStatus,l.ISettingRegistry,d.IStateDB],optional:[o.IThemeManager],activate:(e,t,n,a,o,s)=>{console.log("Oceanum datamesh connect extension is loaded");const l=c.ServerConnection.makeSettings(),d=r.URLExt.join(l.baseUrl,"oceanum","env"),p=e=>{const t=e.get("datameshToken");t&&t.user&&(window.datameshToken=t.user,fetch(d+"/",{method:"POST",headers:{authorization:`Token ${l.token}`},body:JSON.stringify({DATAMESH_TOKEN:t.user})}).then((e=>console.log(e)))),window.injectToken=e.get("injectToken").user};o.load("@oceanum/oceanumlab:plugin").then((e=>{e.changed.connect(p,void 0),p(e)}));const u=t=>{const n="datamesh-ui";if((0,i.find)(e.shell.widgets("main"),((e,t)=>e.id===n)))return void e.shell.activateById(n);const a=new E;a.title.label="Oceanum Datamesh",a.id=n,a.title.closable=!0,a.title.icon=C,a.addClass("datamesh-ui"),e.shell.add(a,"main")},m=new D({app:e,name:"Datamesh Connect",icon:C,openDatameshUI:u,getCurrentWidget:()=>e.shell.currentWidget});m.id="datamesh-connect",m.title.icon=C,m.title.caption="Datamesh Connect",n.add(m,"datamesh-connect"),e.shell.add(m,"left",{rank:900}),e.commands.addCommand("datamesh-ui:open",{execute:e=>{u()}})}},S=j},760:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(645),o=n.n(a)()((function(e){return e[1]}));o.push([e.id,".datasource-drag-image {\n  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);\n  width: var(--jp-private-notebook-dragImage-width);\n  height: var(--jp-private-notebook-dragImage-height);\n  color: var(--jp-ui-font-color1);\n  background: var(--jp-layout-color1);\n}\n\n.datamesh-iframe {\n  width: 98%;\n  height: 98%;\n  padding: 5px;\n}\n\n.datamesh-connect {\n  color: var(--jp-ui-font-color1);\n  background: var(--jp-layout-color1);\n  height: 100%;\n}\n\n.datamesh-connect a {\n  color: var(--jp-content-link-color);\n}\n\n.datamesh-connect-header {\n  font-weight: bold;\n  padding: 8px 10px;\n  display: flex;\n  justify-content: space-between;\n}\n\n.datamesh-connect-header p {\n  font-weight: bold;\n}\n\n.add-connection {\n  border-radius: 4px;\n}\n\n.add-connection :hover {\n  background-color: #ddd;\n}\n\n.datasource-list-item {\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);\n  display: flex;\n  flex-direction: column;\n  margin: 0;\n  padding: 0;\n}\n\n.open-datamesh-ui {\n  cursor: pointer;\n}\n\n.datamesh-workspace-name {\n  flex: 0 0 auto;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n  padding: 8px 8px 8px 12px;\n  margin: 0;\n  margin-left: 0;\n  margin-bottom: 10px;\n  font-size: var(--jp-ui-font-size1);\n}\n\n.datasource-item-expand,\n.datasource-item-action,\n.datasource-item-expand.jp-mod-styled {\n  background-color: transparent;\n  vertical-align: middle;\n  padding: 0;\n  width: 20px;\n  border: none;\n}\n\n.datasource-item-expand:hover {\n  cursor: pointer;\n}\n\n.datasource-item-details {\n  overflow-x: auto;\n  overflow-y: auto;\n  display: block;\n  padding: 5px;\n  margin: 5px;\n  border: 1px solid var(--jp-border-color2);\n  border-radius: 2px;\n  color: var(--jp-ui-font-color1);\n  background-color: var(--jp-layout-color1);\n}\n\n.datasource-item-details textarea {\n  color: var(--jp-ui-font-color1);\n}\n\n.datasource-item-action {\n  display: inline-flex;\n  align-self: flex-end;\n  align-items: center;\n  height: 100%;\n  border: none;\n}\n\n.datasource-item-name {\n  flex-grow: 1;\n  font-size: var(--jp-ui-font-size1);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding: 4px 0 4px 2px;\n  line-height: 28px;\n}\n\n.datasource-item-action:hover,\n.datasource-item-name:hover {\n  cursor: pointer;\n}\n\n.datasource-item-title {\n  align-items: center;\n  display: flex;\n  flex-direction: row;\n  padding: 0 4px;\n  height: 36px;\n}\n\n.datasource-item-title:hover {\n  background-color: var(--jp-layout-color2);\n}\n\n.datasource-query-field span {\n  margin-left: 5px;\n  white-space: nowrap;\n  font-size: var(--jp-ui-font-size0);\n}\n\n.expanded {\n  background-color: var(--jp-layout-color2);\n  padding: 2px;\n}\n",""]);const r=o},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(a)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(o[s]=!0)}for(var i=0;i<e.length;i++){var c=[].concat(e[i]);a&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},549:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var a=n(379),o=n.n(a),r=n(760);o()(r.Z,{insert:"head",singleton:!1});const s=r.Z.locals||{}},379:(e,t,n)=>{var a,o=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),r=[];function s(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].identifier===e){t=n;break}return t}function i(e,t){for(var n={},a=[],o=0;o<e.length;o++){var i=e[o],c=t.base?i[0]+t.base:i[0],l=n[c]||0,d="".concat(c," ").concat(l);n[c]=l+1;var p=s(d),u={css:i[1],media:i[2],sourceMap:i[3]};-1!==p?(r[p].references++,r[p].updater(u)):r.push({identifier:d,updater:g(u,t),references:1}),a.push(d)}return a}function c(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var r=n.nc;r&&(a.nonce=r)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var s=o(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var l,d=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function p(e,t,n,a){var o=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=d(t,o);else{var r=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function u(e,t,n){var a=n.css,o=n.media,r=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var m=null,h=0;function g(e,t){var n,a,o;if(t.singleton){var r=h++;n=m||(m=c(t)),a=p.bind(null,n,r,!1),o=p.bind(null,n,r,!0)}else n=c(t),a=u.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=i(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var o=s(n[a]);r[o].references--}for(var c=i(e,t),l=0;l<n.length;l++){var d=s(n[l]);0===r[d].references&&(r[d].updater(),r.splice(d,1))}n=c}}}}}]);